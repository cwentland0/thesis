\documentclass[a4paper,12pt,openany]{book}


\usepackage[margin=1in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{appendix}
\usepackage{setspace}
% \usepackage{sectsty}
\usepackage[nottoc]{tocbibind}
\usepackage{titletoc}
%\usepackage{tocloft}

\usepackage{algorithm}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{comment}
\usepackage{float}
\usepackage{graphicx}
\usepackage[hidelinks]{hyperref}
\usepackage{longtable}
\usepackage{mathtools}
\usepackage{pdflscape}
\usepackage{pdfpages}
\usepackage{relsize}
\usepackage{subfigure}
\usepackage{titlesec}
\usepackage{xcolor}
\usepackage{csquotes}
\usepackage{arydshln}

\usepackage[
    style=numeric,
    sorting=none,
]{biblatex}
\addbibresource{ref.bib}

% \setlength{\parindent}{0pt}
\pagestyle{plain}
\doublespacing


% Formatting table of contents %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter

    \titlecontents{chapter}[0em]{\addvspace{0em}}%
        {\bfseries\@chapapp\ \thecontentslabel:\ }%
        {\hspace{-0em}}{\hfill\contentspage}[\addvspace{0pt}]

    \def\__mychapapp{\protect\@chapapp}
    \g@addto@macro\appendices{
        \addtocontents{toc}{
            \protect\renewcommand{\__mychapapp}{\appendixname}
        }
    }

\makeatother

\newcommand{\stoptocwriting}{%
  \addtocontents{toc}{\protect\setcounter{tocdepth}{-5}}}

\newcommand{\resumetocwriting}{%
  \addtocontents{toc}{\protect\setcounter{tocdepth}{\arabic{tocdepth}}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% List of appendices %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand\listappendixname{List of Appendices}
\makeatletter
    \newcommand\appchapter[1]{
        \chapter{#1}
        \addcontentsline{app}{chapter}{Appendix \thechapter: #1}
    }

    \newcommand\appsection[1]{
        \section{#1}
        \addcontentsline{app}{section}{\thesection\hspace{0.5em} #1}
    }

    \newcommand\appsubsection[1]{
        \subsection{#1}
        \addcontentsline{app}{subsection}{\thesubsection\hspace{0.5em} #1}
    }

    \newcommand\appsubsubsection[1]{
        \subsubsection{#1}
    }

    \newcommand\listofappendices{
        \chapter*{\listappendixname}\@starttoc{app}
    }
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Centering chapter titles %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
    \titleformat{\chapter}[display]{\bfseries\centering}{\Large \@chapapp\ \thechapter}{1em}{\Large}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Removing double page before main matter %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
\renewcommand\mainmatter{\clearpage\@mainmattertrue\pagenumbering{arabic}}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliography{ref}

\input{commands}

\begin{document}

\raggedbottom

\frontmatter
\input{./Chapters/FrontMatter/FrontPage}
\pagenumbering{roman}
\input{./Chapters/FrontMatter/Orcid}
\input{./Chapters/FrontMatter/Acknowledgements}

\renewcommand{\contentsname}{\begin{center}\vspace{-2em}Table of Contents\end{center}}
\tableofcontents
\listoftables
\listoffigures
\listofappendices
\addcontentsline{toc}{chapter}{List of Appendices}

\input{./Chapters/FrontMatter/Abstract}

\mainmatter
\input{Chapters/Overview/main.tex}
\input{Chapters/FlowModeling/main.tex}
\input{Chapters/ProjROMs/main.tex}
\input{Chapters/TransientFlame/main.tex}
\input{Chapters/CavityAndCVRC/main.tex}
\input{Chapters/NineElement/main.tex}
\input{Chapters/Conclusion/main.tex}

\begin{appendices}
\appendixpage
\addappheadtotoc
\stoptocwriting
\input{Chapters/Appendices/ANNArch/main.tex}
\input{Chapters/Appendices/CostAnalysis/main.tex}
\resumetocwriting
\end{appendices}

% \bibliographystyle{plain}
\printbibliography


\end{document}
\documentclass[]{beamer}

% make header narrower
% \PassOptionsToPackage{height=2em}{beamerouterthemesidebar}

% needed for bold mathmode
\DeclareFontShape{OT1}{cmss}{b}{n}{<->ssub * cmss/bx/n}{}

\usepackage{changepage}
\usepackage{xspace}
\usepackage{soul}
\usepackage{amsfonts}
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\usepackage{framed}
\usepackage{wrapfig}
\usepackage{caption}
\usepackage{tcolorbox}
\usepackage{arydshln}

\mode<presentation> {
\usepackage{subcaption}
\usepackage{algorithm,algorithmic}
\usepackage[titletoc,title]{appendix}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsmath,amssymb}
\usepackage{mathtools}
\captionsetup{compatibility=false}
\usepackage{blindtext}
\usepackage{tcolorbox}
\usepackage[final]{animate}
\usepackage{comment}
\usepackage{appendixnumberbeamer}
\usepackage{booktabs}
\usepackage{tikz}
\usetikzlibrary{calc,matrix}

\usetheme{AnnArbor}

\definecolor{myblue}{rgb}{0,0.156,0.375}
\definecolor{mymaize}{rgb}{1.,0.824,0.227}
\definecolor{beamer@myblue}{rgb}{0.02,0.1786,0.37109}
\definecolor{beamer@mymaize}{rgb}{1.,0.824,0.227}
\setbeamercolor{structure}{fg=beamer@myblue}
\setbeamercolor*{title}{use=structure,bg=beamer@mymaize,fg=beamer@myblue}
\setbeamercolor*{frametitle}{use=structure,bg=beamer@mymaize,fg=beamer@myblue}
\setbeamercolor*{palette primary}{use=structure,fg=beamer@mymaize,bg=beamer@myblue}
\setbeamercolor*{palette secondary}{use=structure,fg=beamer@mymaize,bg=beamer@myblue}
\setbeamercolor*{palette tertiary}{use=structure,fg=beamer@mymaize,bg=beamer@myblue}

\setbeamertemplate{frametitle}{%
    \nointerlineskip%
    \begin{beamercolorbox}[wd=\paperwidth,ht=2.5ex,dp=1ex]{frametitle}
        \hspace*{1ex}\insertframetitle%
    \end{beamercolorbox}%
}

\usepackage{appendixnumberbeamer}
\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}

\usepackage{textpos}
}

\newcommand*{\Scale}[2][4]{\scalebox{#1}{$#2$}}%
\newcommand*{\Resize}[2]{\resizebox{#1}{!}{$#2$}}%

% \addtobeamertemplate{frametitle}{}{%
% \begin{textblock*}{155mm}(-0.19\textwidth,-1.35cm)
% \end{textblock*}}

\usepackage{xcolor}

\beamertemplatenavigationsymbolsempty
\addtobeamertemplate{navigation symbols}{}{%
    \usebeamerfont{footline}%
    \usebeamercolor[fg]{footline}%
    \hspace{1em}%
    % \insertframenumber/\inserttotalframenumber
}

% Syntax: \colorboxed[<color model>]{<color specification>}{<math formula>}
\newcommand*{\colorboxed}{}
\def\colorboxed#1#{%
  \colorboxedAux{#1}%
}
\newcommand*{\colorboxedAux}[3]{%
  % #1: optional argument for color model
  % #2: color specification
  % #3: formula
  \begingroup
    \colorlet{cb@saved}{.}%
    \color#1{#2}%
    \boxed{%
      \color{cb@saved}%
      #3%
    }%
  \endgroup
}

\makeatletter
\newcommand{\miniscule}{\@setfontsize\miniscule{4}{5}}% \tiny: 5/6
\makeatother

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

\input{commands}
\graphicspath{{./Images/}}

%---------------------------------------------------
%	TITLE PAGE
%---------------------------------------------------

\title[]{Robust and Scalable Projection-based \\ Reduced-order Models for Reacting Flows}

\institute[University of Michigan]
{
\vspace{0.3 in}
\Large Christopher R. Wentland \\
\small \underline{Dissertation Committee} \\
Karthik Duraisamy \\
Cheng Huang \\
Jesse Capecelatro \\
Krzysztof Fidkowski \\
\vspace{1em}
\tiny University of Michigan, Ann Arbor - Computational Aerosciences Laboratory
}

\date{\today}

\begin{document}
\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

\section*{Introduction}

\begin{frame}{``New space'' era}
    \begin{itemize}
        \item Varying mission parameters
        \begin{itemize}
            \item Payload: satellite, probe, lander, humans
            \item Trajectory: LEO/GTO, translunar, deep space
            \item Capacity: 100 - 150,000 kg to LEO
        \end{itemize}  
        \item Many propulsion configurations
        \begin{itemize}
            \item Solid, bipropellant, hypergolic
            \item (Non-)cryogenic liquid, gaseous propellant 
            \item Injector geometry, flow rates
            \item Gas-generator, expander, tap-off power cycle
        \end{itemize}
    \end{itemize}
	\vspace{1em}
	\begin{minipage}{0.33\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{intro/be4.jpg}
			\caption*{\tiny{Blue Origin, 2018}}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.33\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{intro/aeonR.png}
			\caption*{\tiny{Relativity Space, 2022}}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.28\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{intro/delphin.jpeg}
			\caption*{\tiny{John Kraus, 2021}}
		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Cost of experiments (in 2022 USD)}
    \begin{itemize}
        \item Rocketdyne F-1 (Saturn V)
        \begin{itemize}
            \item \$4.8 billion development cost
            \item \$30 million per unit
            \item \$1.6 billion per launch
        \end{itemize}
        \item SpaceX Merlin 1D (Falcon Heavy)
        \begin{itemize}
            \item \$1 million per unit
            \item \$97 million per launch
        \end{itemize}
    \end{itemize}
	\begin{minipage}{0.49\linewidth}
		\begin{figure}
			\includegraphics[width=0.9\linewidth]{intro/f1TestStand.jpg}
			\caption*{\tiny{NASA, 1966}}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.49\linewidth}
		\begin{figure}
			\includegraphics[width=0.9\linewidth]{intro/merlin1dTestStand.jpg}
			\caption*{\tiny{SpaceX, 2013}}
		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Cost of simulations}
    \begin{itemize}
        \item IBM Summit at ORNL
        \begin{itemize}
            \item $\sim$\$200 million (2019 USD) to design and build
            \item 13 MW peak consumption ($\sim$11,000 homes)
            \item $\sim$\$10 million annual energy cost (overestimated)
        \end{itemize}
        \item Combustion LES/DNS
        \begin{itemize}
			\item Years to develop/validate code
            \item $\numDOF \sim \; \text{Re}^{9/4}$
            \item 50+ species, 100+ reactions
            \item $\Delta t = \mathcal{O}(1\text{e-}9 \; s)$
        \end{itemize}
    \end{itemize}
	\centering
	\begin{minipage}{0.3\linewidth}
		\centering
		\begin{figure}
			\centering
			\includegraphics[width=0.87\linewidth]{intro/combustionDNS.png}
			\caption*{\tiny{Treichler et al, 2017}}
		\end{figure}
	\end{minipage}
	\hspace{1cm}
	\centering
	\begin{minipage}{0.3\linewidth}
		\centering
		\begin{figure}
			\centering
			\includegraphics[width=0.91\linewidth]{intro/jetCrossflowDNS.png}
			\caption*{\tiny{Grout et al., 2011}}
		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Data-driven reduced-order models (ROMs)}
	\begin{itemize}
		\item Learning cheap models from high fidelity simulations, experiments
		\item Evolving \textbf{low-dimensional} state approximation in time
		\item Non-intrusive methods
		\begin{itemize}
			\item Only require system output
			% \item Black/gray box models
			\item Kriging, operator inference, ANNs
		\end{itemize}
		\item Intrusive methods
		\begin{itemize}
			\item Directly manipulate governing equations
			\item Galerkin, Petrov--Galerkin projection
		\end{itemize}
		\item \textbf{Not} reduced-fidelity models, e.g.
		\begin{itemize}
			\item Reduced chemical mechanisms
			\item Flamelet-progress variable models
			\item Flame transfer functions
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{Projection-based ROMs (PROMs) of non-linear systems}
    \begin{itemize}
        \item Mapping from low-dim latent space to approximate solution manifold
        \item Map governing equations onto low-dim manifold, evolve in time
    \end{itemize}
	\centering
	\begin{minipage}{0.49\linewidth}
		\centering
		\vspace{-2em}
		\begin{align*}
			\ode{\stateVec}{\timeVar} = \rhsFunc{\stateVec}&, \quad \ode{\stateVecCoef}{\timeVar} = \encoderFunc{\rhsFunc{\decoderFunc{\stateVecCoef}}} \\[1em]
			\stateVec \in \mathbb{R}^{\numDOF}&, \quad \stateVecCoef \in \mathbb{R}^{K} \\[1em]
			\numDOF &\gg K
		\end{align*}
	\end{minipage}
	\hspace{-2em}
	\begin{minipage}{0.49\linewidth}
		\begin{figure}
			\only<1>{\includegraphics[width=0.9\linewidth]{Images/theory/mapExample_3d.png}}
			\only<2>{\includegraphics[width=0.9\linewidth]{Images/theory/mapExample_2d.png}}
		\end{figure}
	\end{minipage}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		PROMs of non-linear systems have \textbf{no stability guarantees} \\
		Accuracy/robustness are rarely tested beyond canonical problems
	\end{tcolorbox}
\end{frame}

\begin{frame}{Objectives}
	\begin{itemize}
		\item 
	\end{itemize}
\end{frame}

\begin{frame}{Contributions}
    \begin{enumerate}
		\item PERFORM, Python package for prototyping novel ROM methods
        \item State-of-the-art PROMs for multi-scale, multi-physics flow systems
        \item Scalable PROM solver in high-performance combustion CFD code
        \item Analysis of cost and performance of sparse sampling methods
        \item First study of PROMs for 3D multi-injector rocket combustor, containing $>$ 250 million DOFs
        \item Truly predictive PROMs for single-element rocket combutor
        \item Best practices for PROMs of multi-scale systems
    \end{enumerate}
\end{frame}

\section*{Projection ROMs}

\begin{frame}{Projection-based ROMs}
    \begin{itemize}
		\item General non-linear ODE
		\begin{equation*}
			\ode{\consVec}{\timeVar} + \rhsFunc{\consVec} = \zeroVec \quad \consVec \in \mathbb{R}^{\numDOF}
		\end{equation*}
			\item Low-dimensional affine representation ($\numConsModes \ll \numDOF$)
		\begin{align*}
			\consVec(\timeVar) \approx \consVecRom(\timeVar) &\defEq \consVecCent + \consScale \sum^{\numConsModes}_{i=1} \consVarCoef{i}(\timeVar) \consTrialVec{i} \\
			&= \consVecCent + \consScale \consTrial \consVecCoef(\timeVar)
		\end{align*}
		\begin{equation*}
			\consVecCoef \in \mathbb{R}^{\numConsModes}, \; \consTrial \in \mathbb{R}^{\numDOF \times \numConsModes}
		\end{equation*}
		\item Centering profile $\consVecCent$ and scaling matrix $\consScale$ are crucial; more later
		\begin{equation*}
			\consScale \defEq \text{diag}\left( \consScaleVar{1}, \; \consScaleVar{2}, \; \hdots \;, \; \consScaleVar{\numDOF} \right)
		\end{equation*}
	\end{itemize}
\end{frame}

\begin{frame}{Linear trial space}
    \begin{itemize}
        \item The proper orthogonal decomposition (POD)\footnotemark[1]
        \begin{equation*}
            \consTrial = \argmin{\dummyMatOne \in \mathbb{R}^{\numDOF \times \numConsModes}} \norm{\consDataMat - \dummyMatOne \dummyMatOne^\top \consDataMat}_2^2
        \end{equation*}
        \begin{equation*}
            \consDataMat = \basisMat \singVecMat \rightSingVecMat^\top, \quad \consTrial \leftarrow \basisMat[:, {:}\numConsModes]
        \end{equation*}
    \end{itemize}
	\centering
	\vspace{-0.8em}
	\begin{figure}
		\includegraphics[width=0.5\linewidth]{theory/podProfileConverge.png}
	\end{figure}
	\footnotetext[1]{\tiny{Berkooz et al., \textit{Annu Rev Fluid Mech}, Vol. 25, 1993, pp. 539-575.}}
\end{frame}

\begin{frame}{Non-linear trial manifold}
	\begin{itemize}
		\item Linear basis approximates non-linear solution manifold poorly
		\item Autoencoders learn mapping b/w solution and latent manifolds\footnotemark[2]
	\end{itemize}
	\vspace{1em}
	\begin{equation*}
		\consVec(\timeVar) \approx \consVecRom(\timeVar) \defEq \consVecCent + \consScale \mathbf{g}\left(\consVecCoef(\timeVar)\right)
	\end{equation*}
	\begin{figure}
		\begin{minipage}{0.4\linewidth}
			\includegraphics[width=0.99\linewidth,trim={2em 2em 2em 2em},clip]{theory/tangentPlane.png}
		\end{minipage}
		\begin{minipage}{0.59\linewidth}
			\includegraphics[width=0.99\linewidth]{theory/CAE_dense.png}
		\end{minipage}
	\end{figure}
	\footnotetext[2]{\tiny{Lee and Carlberg, \textit{J. Comp. Phys.}, Vol. 404, 2020.}}
\end{frame}

\begin{frame}{The test basis}
    \begin{itemize}
        \item Inserting approximation, no order reduction yet
        \begin{equation*}
            \resScaleInv \left[\consScale \consTrial \ode{\consVecCoef}{\timeVar} + \rhsFunc{\consVecCent + \consScale \consTrial \consVecCoef}\right] = \zeroVec 
        \end{equation*}
        \item Project via test basis $\testBasis \in \mathbb{R}^{\numDOF \times \numConsModes}$, rearrange
        \begin{equation*}
            \ode{\consVecCoef}{\timeVar} + \left[ \testBasis^\top \resScaleInv \consScale \consTrial \right]^{-1} \testBasis^\top \resScaleInv \rhsFunc{\consVecRom} = \zeroVec
        \end{equation*}
        \item $\testBasis = \consTrial$: Galerkin projection
        \item $\testBasis \neq \consTrial$: Petrov--Galerkin projection 
    \end{itemize}
\end{frame}

\begin{frame}{Least-squares Petrov--Galerkin (LSPG)\footnotemark[3]}
    \begin{itemize}
		\item Fully-discrete residual (e.g. BDF1)
		\begin{equation*}
			\resFuncIter{\timeIdx}{\consVecCoef^{\newtonIdx}} \defEq \consScale \consTrial \left( \consVecCoef^{\newtonIdx} - \consVecCoef^{\timeIdx-1} \right) + \dt \, \rhsFunc{\consVecCent + \consScale \consTrial \consVecCoef^{\newtonIdx}} = \zeroVec
		\end{equation*}
		\item Minimize with Gauss--Newton
		\begin{equation*}
			\delta \consVecCoef^{\newtonIdx, \timeIdx} = \argmin{\dummyVec \in \mathbb{R}^{\numConsModes}} \norm{\resScaleInv \left(\pde{\resFuncIter{\timeIdx}{\dummyVec}}{\dummyVec} \dummyVec + \resFuncIter{\timeIdx}{\dummyVec}\right)}_2^2
		\end{equation*}
		\item Equivalent to Petrov--Galerkin projection with test basis
		\begin{equation*}
			\testBasis = \resScaleInv \pde{\resFuncIter{\timeIdx}{\consVecCoef^{\newtonIdx}}}{\consVec} \consScale \consTrial
		\end{equation*}
	\end{itemize}
	\vspace{-1em}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		LSPG is \textbf{discrete-optimal} at every time step
	\end{tcolorbox}
	\footnotetext[3]{\tiny{Carlberg el al., \textit{Int. J. Numer. Meth. Engng}, Vol. 86, 2010, pp. 155--181.}}
\end{frame}

\begin{frame}{State of the art in 2017}
	\begin{itemize}
		\item PROMs for parametrized elliptic problems are extremely robust\footnotemark[4]
		\item Galerkin ROMs are generally unstable for unsteady problems
		\item LSPG is leap forward, biggest case in 3D Ahmed body\footnotemark[5]
		\item First studies of PROMs for reacting flows suffer from instabilities\footnotemark[6]
	\end{itemize}
	
	\begin{minipage}{0.4\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{theory/ahmed.png}
			\caption*{\tiny{Carlberg et al., 2013}}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.58\linewidth}
		\begin{figure}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth]{10}{theory/single_injector/fom/fig_}{00000}{00046}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth]{10}{theory/single_injector/rom/fig_}{00000}{00046}
			\caption*{\tiny{Huang, 2018}}
		\end{figure}
	\end{minipage}

	\footnotetext[4]{\tiny{Hesthaven et al., \textit{Certified Reduced Basis Methods for Parametrized Partial Differential Equations}, Springer, 2015.}}
	\footnotetext[5]{\tiny{Carlberg et al., \textit{J Comp Phys}, Vol. 242, 2013, pp. 623--647.}}
	\footnotetext[6]{\tiny{Huang et al., \textit{AIAA Propulsion and Energy}, 2018.}}
\end{frame}

\begin{frame}{Generalizing least-squares ROMs}
    \begin{itemize}
		\item LSPG trial space formulated for the conserved variables, but alternative variables can prove useful
		\begin{itemize}
			\item Entropy variables
			\item Characteristic variables
			\item Quadratic lifting variables
		\end{itemize}
		\item Choose \textbf{any} complete set of variables, e.g. primitive variables
		\begin{equation*}
			\stateVar_p \defEq \left[ p, \; u_i, \; T, \; Y_l \right]
		\end{equation*}
		\item Construct linear approximation, supply mapping to conserved variables
		\begin{equation*}
			\primVecRom(\timeVar) \defEq \primVecCent + \primScale \primTrial \primVecCoef(\timeVar)
		\end{equation*}
		\begin{equation*}
			\consVec \defEq \consVec \left( \primVecRom \right)
		\end{equation*}
	\end{itemize}
\end{frame}

\begin{frame}{\small{Model-form preserving least-squares with variable transformation (MP-LSVT)\footnotemark[7]}}
	\begin{itemize}
		\item Frame residual in terms of target state
		\begin{equation*}
			\resFuncIter{\timeIdx}{\primVecCoef^{\newtonIdx}} \defEq \consFunc{\primVecCent + \primScale \primTrial \primVecCoef^{\newtonIdx}} - \consVec^{\timeIdx-1} + \dt \, \rhsFunc{\primVecCent + \primScale \primTrial \primVecCoef^{\newtonIdx}} = \zeroVec
		\end{equation*}
		\item Gauss--Newton w/r/t \textbf{target variable} modal coefficients
		\begin{equation*}
			\testBasis = \resScaleInv \pde{\resFuncIter{\timeIdx}{\primVecCoef^{\newtonIdx}}}{\primVec} \primScale \primTrial
		\end{equation*}
	\end{itemize}
	\begin{minipage}{0.49\linewidth}
		\centering
		\begin{figure}
			\includegraphics[width=0.75\linewidth]{theory/mplsvt_err_vs_modes.png}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.49\linewidth}
		\centering
		\begin{figure}
			\includegraphics[width=0.75\linewidth]{theory/mplsvt_pressure_probe.png}
		\end{figure}
	\end{minipage}
	\footnotetext[7]{\tiny{Huang, \textbf{Wentland}, and Duraisamy, \textit{J Comp Phys.}, Vol. 448, 2022, pp. 110742.}}
\end{frame}

\section*{Hyper-reduction}

\begin{frame}{The lifting bottleneck}
    \begin{itemize}
		\item Non-linear terms $\rhsFunc{\primVecRom}$ still scale with full dimension $\numDOF$
		\item For same time integrator and \dt, ROM is usually \textbf{more} expensive
		\item Can we approximate non-linear terms from a few samples?
		\begin{equation*}
			\rhsFunc{\primVec} \approx \sampFunc{\sampMat \rhsFunc{\primVec}}, \quad \sampMat \in \mathbb{R}^{\numSamps \times \numDOF}
		\end{equation*}
	\end{itemize}
	\vspace{1em}
	\begin{figure}
		\centering
		\includegraphics[width=0.55\linewidth]{theory/samplingHelperVis.png}
	\end{figure}
\end{frame}

\begin{frame}{Hyper-reduction by gappy POD}
    \begin{itemize}
		\item Approximate non-linear terms with POD basis $\deimBasis \in \mathbb{R}^{\numDOF \times \numResModes}$
		\begin{align*}
			\resFunc{\primVecCoef} \approx \resApproxFunc{\primVecCoef} &= \deimBasis \dummyVec \\
			\sampMat \resApproxFunc{\primVecCoef} &= \sampMat \deimBasis \dummyVec
		\end{align*}
		\item Least-squares regression, gappy POD\footnotemark[8] ($\numSamps > \numResModes$)
		\begin{equation*}
			\resApproxFunc{\primVecCoef} \defEq \deimBasis \left[ \sampMat \deimBasis \right]^{+} \sampMat \resFunc{\primVecCoef}
		\end{equation*}
		\item MP-LSVT hyper-reduced PROM (HPROM)
		\begin{equation*}
			\left[ \testBasis^\newtonIdx \right]^\top \testBasis^\newtonIdx \delta \primVecCoef^{\newtonIdx} = -\left[\testBasis^\newtonIdx \right]^\top \deimBasis \left[ \sampMat \deimBasis \right]^{+} \sampMat \resScaleInv \resFunc{\primVecCoef^{\newtonIdx}}
		\end{equation*}
		\begin{equation*}
			\testBasis^\newtonIdx \defEq \deimBasis \left[ \sampMat \deimBasis \right]^{+} \sampMat \resScaleInv \jacobResPrim^{\newtonIdx} \primTrial
		\end{equation*}
	\end{itemize}
	\footnotetext[8]{\tiny{Everson and Sirovich, \textit{J Opt Soc Am A}, Vol. 12 (8), 1995, pp 1657--1664.}}
\end{frame}

\begin{frame}{Sampling algorithms}
    \begin{itemize}
		\item Computing optimal sampling $\sampMat$ is intractable
		\item Usually resort to greedy (locally-optimal) algorithms
		\begin{itemize}
			\item GNAT (two variants)$^{5,9}$
			\item Eigenvector-based\footnotemark[9]
		\end{itemize}
	\end{itemize}
	\vspace{-1em}
	\begin{minipage}{0.13\linewidth}
		\footnotesize
		\vspace{3.9em}
		\textbf{Random}
		\normalsize

		\vspace{3em}

		\footnotesize
		\textbf{GNAT}

		\vspace{3.7em}

		\footnotesize
		\textbf{Eigenvec}

		\vspace{4em}
	\end{minipage}
	\centering
	\begin{minipage}{0.8\linewidth}%{0.84\linewidth}
		\includegraphics[width=0.85\linewidth,trim={0.2em 2em 0.3em 2em},clip]{Images/theory/iblanks/random_iblank_z.png}

		\includegraphics[width=0.85\linewidth,trim={0.2em 2em 0.3em 2em},clip]{Images/theory/iblanks/greedy_ben_iblank_z.png}

		\includegraphics[width=0.85\linewidth,trim={0.2em 2em 0.3em 2em},clip]{Images/theory/iblanks/eigenvec_iblank_z.png}
	\end{minipage}
	\vspace{-2em}
	\footnotetext[9]{\miniscule{Peherstorfer et al., \textit{SIAM J Comp Sci}, Vol. 42, 2020, pp. 2837--2864.}}
\end{frame}

% \begin{frame}{Online HPROM scalability}
% 	\begin{itemize}
% 		\item Compute scalability is easy; memory scalability is tricky
% 		\item Only allocate mesh elements required for calculating $\sampMat \rhsFunc{\cdot}$
% 		\item Disjoint graphs induce much lower MPI overhead
% 		\item Field reconstruction done as post-processing step
% 	\end{itemize}
% 	\begin{minipage}{0.49\linewidth}
% 		\begin{figure}
% 			\includegraphics[width=0.8\linewidth]{theory/sampling_3d_2ndOrder.png}
% 		\end{figure}
% 	\end{minipage}
% 	\begin{minipage}{0.49\linewidth}
% 		\begin{figure}
% 			\includegraphics[width=0.8\linewidth]{theory/load_balancing_withEdgeCuts_noSyms.png}
% 		\end{figure}
% 	\end{minipage}
% \end{frame}

\section*{Numerical Experiments}

\begin{frame}{Full-order model}
    \begin{itemize}
		\item Compressible Navier--Stokes equations with scalar transport
		\item 2nd-order unstructured finite volume
		\item BDF2 time integration w/ pseudo time-stepping
		\item Finite-rate and flamelet-progress variable chemistry models
	\end{itemize}
	\begin{equation*}
		\pde{\consVec}{\timeVar} + \nabla \cdot (\invFluxDir - \viscFluxDir) = \sourceVec
	\end{equation*}
	\scriptsize
	\def\arraystretch{2}
	\begin{equation*}
		\consVec = \left[
		\begin{array}{c}
		\rho \\ \rho u \\ \rho v \\ \rho w \\ \rho h^0 - p \\ \hdashline[2pt/2pt] \rho Y_{\specIdx} \\
		\end{array}
		\right]  \; \;
		\invFluxDir = \left[
		\begin{array}{c}
		\rho u_i \\  \rho uu_i + \delta_{xi} p \\ \rho vu_i + \delta_{yi} p \\ \rho wu_i + \delta_{zi} p \\ \rho h^0 u_i \\ \hdashline[2pt/2pt] \rho Y_{\specIdx} u_i 
		\end{array}
		\right]  \; \;
		\viscFluxDir = \left[
		\begin{array}{c}
		0 \\ \tau_{ix} \\ \tau_{iy} \\ \tau_{iz} \\ u_j \tau_{ji} - q_i \\ \hdashline[2pt/2pt] \rho D_\specIdx  \pde{Y_{\specIdx}}{x_i}
		\end{array}
		\right]  \; \;
		\mathbf{s} = \left[
		\begin{array}{c}
		0 \\ 0 \\ 0 \\ 0 \\ 0 \\ \hdashline[2pt/2pt] \dot{\omega}
		\end{array} \right]
	\end{equation*}
	\normalsize
\end{frame}

\begin{frame}{\footnotesize{Prototyping Environment for Reacting Flow Order Reduction Methods (PERFORM)\footnotemark[10]}}
	\begin{itemize}
		\small
		\item Open-source 1D reacting flow solver w/ flexible ROM API
		\item Used for linearized ROMs\footnotemark[0], adaptive HPROMs\footnotemark[0], AERO 577 projects
		\normalsize
	\end{itemize}
	\vspace{0.5em}
	\begin{minipage}{0.49\linewidth}
		\includegraphics[width=0.99\linewidth]{Images/experiments/transientFlame/performFOMAPI.png}
	\end{minipage}
	\begin{minipage}{0.49\linewidth}
		\includegraphics[width=0.99\linewidth]{Images/experiments/transientFlame/performROMAPI.png}
	\end{minipage}

	\vspace{1em}
	\centering
	\texttt{https://github.com/cwentland0/perform}
	\footnotetext[10]{\tiny{\textbf{Wentland} and Duraisamy, \textit{J Open Source Soft.}, 2022.}}
\end{frame}

\begin{frame}{Acoustically-forced model premixed flame}
	\begin{itemize}
		\item Fictitious ``reactant'' converts directly to ``product''
		\item Pressure forcing at outlet for parametrically-varied dataset
	\end{itemize}
	\begin{minipage}{0.59\linewidth}
		\animategraphics[autoplay,loop,width=0.99\linewidth,every=50]{10}{Images/experiments/transientFlame/fom/fig_}{10000}{13000}
	\end{minipage}
	\begin{minipage}{0.4\linewidth}
		\vspace{1em}
		\scriptsize
		\begin{table}
			\centering
			\begin{tabular}{ lll }
			\toprule
			Training & Validation & Testing  \\
			\midrule
			100   & 118.75 & 87.5 \\
			112.5 & 156.25 & 93.75 \\
			125   & 193.75 & 106.25 \\
			137.5 &        & 131.25 \\
			150   &        & 143.75 \\
			162.5 &        & 168.75 \\
			175   &        & 181.25 \\
			187.5 &        & 206.25 \\
			200   &        & 212.5 \\
			\bottomrule
			\end{tabular}
			\caption*{Outlet forcing frequency in kHz}
		\end{table}
	\end{minipage}
	\normalsize
\end{frame}

\begin{frame}{Linear trial space: failure}
	\begin{itemize}
		\item Linear basis approximates sharp, propagating flame poorly
		\item Low $\numPrimModes$ $\rightarrow$ smeared solution, high $\numPrimModes$ $\rightarrow$ instability
	\end{itemize}
	\begin{figure}
		\animategraphics[autoplay,loop,width=0.7\linewidth,every=1]{10}{Images/experiments/transientFlame/linear/fig_}{1}{51}
	\end{figure}
\end{frame}

\begin{frame}{Non-linear trial manifold: failure}
	\begin{itemize}
		\item Noisy solution, better temperature prediction but pressure signal lost
		\item Online cost is difficult to justify, auto-diff Jacobian is worst offender 
	\end{itemize}
	\vspace{1em}
	\begin{minipage}{0.6\linewidth}
		\begin{figure}
			\animategraphics[autoplay,loop,width=0.99\linewidth,every=1]{10}{Images/experiments/transientFlame/nonlinear/fig_}{1}{51}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.39\linewidth}
		\scriptsize
		\begin{table}
			\centering
			\begin{tabular}{ lll }
			\toprule
			Model & Cost (FOMs)  \\
			\midrule
			FOM & 1 \\
			Train, $\numPrimModes = 3$ & 13.81 \\
			Train, $\numPrimModes = 10$ & 11.67 \\
			NLM, $\numPrimModes = 3$ & 17.14 \\
			\bottomrule
			\end{tabular}
		\end{table}
	\end{minipage}
\end{frame}

\begin{frame}{Non-intrusive ROMs via LSTMs}
	\begin{itemize}
		\item Recurrent neural network learns evolution of latent state
		\item Excellent off-training predictions in seconds
	\end{itemize}
	\begin{figure}
		\animategraphics[autoplay,loop,width=0.7\linewidth,every=1]{10}{Images/experiments/transientFlame/lstm/fig_}{1}{51}
	\end{figure}
\end{frame}

\begin{frame}{HPROMs of multi-scale, multi-physics system}
	\begin{itemize}
		\item HPROMs rarely tested for larger, practical systems
		\item Understanding the effects of:
		\begin{itemize}
			\item Sampling rate $\numSamps$
			\item Gappy POD regressor dimension $\numResModes$
			\item Sampling algorithm
		\end{itemize}
		\item Stability, accuracy, computational cost
	\end{itemize}
\end{frame}

\begin{frame}{2D transonic flow over an open cavity}
    \begin{itemize}
		\item Ma = 0.6 flow over rectangular cavity (L/D = 2)
		\item 500k DOF, 120 cores $\rightarrow$ 120 CPU-h per 10 ms simulated 
		\item Acoustic resonance between shear layer and trailing edge
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.4\linewidth}
			\vspace{1em}
				\includegraphics[width=0.99\linewidth]{experiments/2d_cavity/tamAndBlockCavity.png}
				\caption*{\tiny{Tam and Block, 1978}}
		\end{minipage}
		\begin{minipage}{0.59\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=50]{10}{Images/experiments/2d_cavity/fom_pressure/fig_Static_Pressure_}{100000}{103000}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{Sparse sampling}
	\begin{itemize}
		\item $\numResModes = 150\text{-}300$, $\numSamps = 0.5\text{-}10\% \times \numDOF$
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\centering
			\includegraphics[width=0.63\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/2d_cavity/iblank/iBlank_random_zoom.png}
			\subcaption{\scriptsize{Random}}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\centering
			\includegraphics[width=0.63\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/2d_cavity/iblank/iBlank_eigenvec_zoom.png}
			\subcaption{\scriptsize{Eigenvector}}
		\end{minipage}
	
		\begin{minipage}{0.49\linewidth}
			\centering
			\includegraphics[width=0.63\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/2d_cavity/iblank/iBlank_greedy_carlberg_zoom.png}
			\subcaption{\scriptsize{GNAT V1}}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\centering
			\includegraphics[width=0.63\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/2d_cavity/iblank/iBlank_greedy_ben_zoom.png}
			\subcaption{\scriptsize{GNAT V2}}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{HPROM performance}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/2d_cavity/sampled_dt2p5e-6_Average_errorRaw_pareto.png}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/2d_cavity/pressure_probe_deim_2p5.png}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{HPROM performance}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=40]{10}{Images/experiments/2d_cavity/fom_pressure_zoom/fig_Static_Pressure_zoom_}{108000}{110000}
			\caption*{FOM}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=16]{10}{Images/experiments/2d_cavity/hprom_pressure_zoom/fig_Static_Pressure_zoom_}{43200}{44000}
			\caption*{$\numResModes = 250, \numSamps = 1\%$}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{3D trucated CVRC combustor}
	\begin{itemize}
		\item Truncated single-element gaseous methane-peroxide combustor\footnotemark[0]
		\item Flamelet-progress variable combustion model (GRI-Mech 1.2)
		\item $\sim$18 mil. DOF, 880 cores $\rightarrow$ 30k CPU-h per simulated millisecond
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
				\includegraphics[width=0.95\linewidth]{Images/experiments/cvrc/geom.png}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_pressure/fig_z_Static_Pressure_}{50000}{55000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_temp/fig_z_Temperature_}{50000}{55000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_z/fig_z_Flamelet_Scalar_Mean_}{50000}{55000}
		\end{minipage}
	\end{figure}

\end{frame}

\begin{frame}{Sparse sampling}
	\begin{figure}
		\centering
		\begin{minipage}{0.3\linewidth}
			\includegraphics[width=0.99\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/cvrc/iblank/random_iblank_iso.png}
			\subcaption{Random}
		\end{minipage}
		\begin{minipage}{0.3\linewidth}
			\includegraphics[width=0.99\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/cvrc/iblank/eigenvec_iblank_iso.png}
			\subcaption{Eigenvector}
		\end{minipage}
	
		\centering
		\begin{minipage}{0.3\linewidth}
			\includegraphics[width=0.99\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/cvrc/iblank/greedy_carlberg_iblank_iso.png}
			\subcaption{GNAT V1}
		\end{minipage}
		\begin{minipage}{0.3\linewidth}
			\includegraphics[width=0.99\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/cvrc/iblank/greedy_ben_iblank_iso.png}
			\subcaption{GNAT V2}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{Offline cost}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/samp_timing_wrt_samprate.png}
			\caption*{$\numResModes = 300$}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/samp_timing_wrt_modes.png}
			\caption*{$\numSamps = 0.25\% \times \numDOF$}
		\end{minipage}
	\end{figure}
	\begin{itemize}
		\item Greedy methods scale exponential with $\numSamps$
		\item Sublinear scaling with $\numResModes$
	\end{itemize}
\end{frame}

\begin{frame}{Load balancing}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/cvrc_partition_stats.png}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/cvrc_partition_comms.png}
		\end{minipage}
		\caption*{10 partitions, various $\numSamps$.}
	\end{figure}
	\begin{itemize}
		\item Random sampling is inefficient, but few MPI comms
		\item Greedy algorithm clustering induces higher MPI overhead
	\end{itemize}
\end{frame}

\begin{frame}{HPROM performance}
	\begin{figure}
		\begin{minipage}{0.35\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/err_contour_random_dt5e-7.png}
			\subcaption{\scriptsize{Random}}
		\end{minipage}
		\begin{minipage}{0.4\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/err_contour_eigenvec_dt5e-7.png}
			\subcaption{\scriptsize{Eigenvector}}
		\end{minipage}
	
		\begin{minipage}{0.35\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/err_contour_gnat1_dt5e-7.png}
			\subcaption{\scriptsize{GNAT, V1}}
		\end{minipage}
		\begin{minipage}{0.4\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/err_contour_gnat2_dt5e-7.png}
			\subcaption{\scriptsize{GNAT, V2}}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{HPROM performance}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/sampled_dt5e-7_Average_errorRaw_pareto.png}
			\caption*{$\dt = 5 \times \dtFOM$}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/pressure_probe_deim_dt5e-7_samp0p0025.png}
			\caption*{$\numSamps = 0.25\% \times \numDOF$, $\numResModes = 300$}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{HPROM performance}
	\begin{minipage}{0.15\linewidth}
		\textbf{FOM}

		\vspace{2.5em}

		\textbf{Random}

		\vspace{2.5em}

		\textbf{Eigenvec}

		\vspace{2.5em}

		\textbf{GNAT V1}

		\vspace{2.5em}

		\textbf{GNAT V2}

	\end{minipage}\hspace{2em}
	\begin{minipage}{0.6\linewidth}
		\begin{figure}
		
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=50]{10}{Images/experiments/cvrc/fom_temp_comp/fig_z_Temperature_}{52500}{55000}
	
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=10]{10}{Images/experiments/cvrc/random_temp/fig_z_Temperature_}{10500}{11000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=10]{10}{Images/experiments/cvrc/eigenvec_temp/fig_z_Temperature_}{10500}{11000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=10]{10}{Images/experiments/cvrc/gnatv1_temp/fig_z_Temperature_}{10500}{11000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=10]{10}{Images/experiments/cvrc/gnatv2_temp/fig_z_Temperature_}{10500}{11000}

		\end{figure}
	\end{minipage}
	
\end{frame}


\begin{frame}{3D nine-element combustor\footnotemark[11]}
	\begin{itemize}
		\item Air Force Center of Excellence ``grand challenge'' case
		\item 12 species, 38 reaction mechanism 
		\item 238 mil. DOF, 2,200 cores $\rightarrow ~\sim$400k CPU-h per 1T mode
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.45\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/9elem/geom_iso.png}
		\end{minipage}
		\begin{minipage}{0.45\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=60]{10}{Images/experiments/9elem/fom_pressure/fig_z_Static_Pressure_}{215000}{218900}
		\end{minipage}
	\end{figure}
	\footnotetext[11]{\tiny{Harvazinski et al., \textit{AIAA Scitech Forum}, 2019}}
\end{frame}

\begin{frame}{Unsampled PROM perfomance}
	\begin{itemize}
		\item Faithful reconstruction with $\numPrimModes \ge 80$
		\item Pressure field lacks some high-frequency content
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/9elem/point_3_Static_Pressure.png}
		\end{minipage}
		\begin{minipage}{0.45\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=2]{10}{Images/experiments/9elem/rom_pressure/fig_z_Static_Pressure_}{4306}{4380}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{Future-state predictivity}
	\begin{itemize}
		\item Trial space cannot represent unseen data
		\item Out-of-training predictions require \textit{adaptation}
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/proj_err_time.png}
		\end{minipage}	
		\begin{minipage}{0.49\linewidth}
			\animategraphics[autoplay,loop,trim={0.5em 0.5em 0.5em 0.5em},clip,width=0.99\linewidth,every=40]{10}{Images/experiments/cvrc/fom_temp_adapt/fig_z_Temperature_}{54000}{56000}	
			
			\animategraphics[autoplay,loop,trim={0.5em 0.5em 0.5em 0.5em},clip,width=0.99\linewidth,every=40]{10}{Images/experiments/cvrc/proj_temp/fig_z_Temperature_}{54000}{56000}	
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{Basis and sampling adaptation}
	\begin{itemize}
		\item AADEIM\footnotemark[0] sampling update criterion
		\begin{equation*}
			\argmax{} \primVec - \primTrial \left[\sampMat \primTrial\right]^+ \sampMat \primVecRom
		\end{equation*}
		\item One-step basis adaptation\footnotemark[0]
		\begin{equation*}
			\primVec^{\timeIdx} = \primVecCent + \primScale \left[\primTrial^{\timeIdx} + \left[\primTrialUpdate\right]^{\timeIdx} \right] \primVecCoef^{\timeIdx},
		\end{equation*}
		\begin{equation*}
			\sampMat^{\timeIdx} [\primTrialUpdate]^{\timeIdx+1} = \sampMat^{\timeIdx} [\primTrialUpdate]^{\timeIdx} + \frac{\sampMat^{\timeIdx} \left[\primScaleInv\left[\primVec^{\timeIdx} - \primVecCent\right] - \primTrial^{\timeIdx} \primVecCoef^{\timeIdx}\right]\left[\primVecCoef^{\timeIdx}\right]^\top}{\left\Vert \primVecCoef^{\timeIdx} \right\Vert^2_2}
		\end{equation*}
		\item New dial to adjust: adaptation interval $\updateFreq$
	\end{itemize}
\end{frame}

\begin{frame}{Adaptive HPROM performance}
	\begin{minipage}{0.15\linewidth}
		\textbf{FOM}

		\vspace{2.5em}

		$\mathbf{\updateFreq = 2}$

		\vspace{2.5em}

		$\mathbf{\updateFreq = 4}$

		\vspace{2.5em}

		$\mathbf{\updateFreq = 5}$

	\end{minipage}\hspace{2em}
	\begin{minipage}{0.6\linewidth}
		\begin{figure}
		
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_temp_adapt_rom/fig_z_Temperature_}{50100}{55000}
	
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=2]{10}{Images/experiments/cvrc/adapt_freq2/fig_z_Temperature_}{1002}{1100}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=2]{10}{Images/experiments/cvrc/adapt_freq4/fig_z_Temperature_}{1002}{1100}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=2]{10}{Images/experiments/cvrc/adapt_freq5/fig_z_Temperature_}{1002}{1100}

		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Adaptive HPROM performance}
	\begin{itemize}
		\item Absolute speedup threshold dictated by $\updateFreq$
		\item Adaptive PROM is \textit{not} independent of $\numDOF$
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/pressure_probe_wrt_iter.png}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/pareto_wrt_iters_Average_errorRaw_pareto.png}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{Best practices}
	\begin{itemize}
		\item Feature scaling
		\begin{itemize}
			\item Data preparation is crucial for accurate trial basis
			\item Centering/normalization are required, exact method not as important
		\end{itemize}
		\item Residual non-dimensionalization
		\begin{itemize}
			\item Failing to non-dimensionalize ROMs leads to terrible conditioning
			\item Constant scaling factors are simple, inexpensive, and robust
		\end{itemize}
		\item Local limiters
		\begin{itemize}
			\item ``Ringing'' from linear trial basis can lead to large over/undershoots
			\item System-specific limiters are a simple hot-fix
		\end{itemize}
		
	\end{itemize}
\end{frame}

\section*{Conclusions}

\begin{frame}{Contributions}
    \begin{enumerate}
        \item State-of-the-art PROMs for multi-scale, multi-physics flow systems
        \item Scalable PROM solver in high-performance combustion CFD code
        \item Analysis of cost and performance of sparse sampling methods
        \item First study of PROMs for 3D multi-injector rocket combustor, containing $>$ 250 million DOFs
        \item Truly predictive PROMs for single-element rocket combutor
        \item PERFORM, Python package for prototyping novel ROM methods
        \item Insight on best practices for PROMs of multi-scale systems
    \end{enumerate}
\end{frame}

\begin{frame}{Publications and presentations}
	\begin{itemize}
		\item Under review
		\vspace{0.5em}
		\begin{itemize}
			\item \tiny \textbf{Wentland, C.R.}, Huang, C., and Duraisamy, K., ``Scalable Projection-based Reduced-order Models for Large Multi-scale Fluid Systems,'' AIAA Journal, submitted for review.
		\end{itemize}
		\item \normalsize Journal articles
		\vspace{0.5em}
		\begin{itemize}
			\item \tiny Arnold-Medabalimi, N., \textbf{Wentland, C. R.}, Huang, C., and Duraisamy, K., ``PLATFORM: Parallel Linear Algebra Tool FOr
			Reduced Modeling,'' \textit{SoftwareX}, Vol. 21, 2023.
			\item \textbf{Wentland, C.R.} and Duraisamy, K., ``PERFORM: A Python package for developing reduced-order models for reacting fluid flows,'' \textit{J. Open Source Softw.}, 2022.
			\item Huang, C., \textbf{Wentland, C.R.}, Duraisamy, K., and Merkle, C., ``Model reduction for multi-scale transport problems using model-form preserving least-squares projections with variable transformation,'' \textit{J. Comp. Phys.}, 2021, Vol. 448, 2021.
        	\item Parish, E.J., \textbf{Wentland, C.R.}, Duraisamy, K., ``The Adjoint Petrov--Galerkin method for non-linear model reduction,'' \textit{Comput. Method Appl. M.}, Vol. 365, 2020.
		\end{itemize}
		\item \normalsize Conference proceedings
		\vspace{0.5em}
		\begin{itemize}
			\item \tiny \textbf{Wentland, C.R.}, Huang, C., and Duraisamy, K., ``Investigation of Sampling Strategies for Reduced-Order Models of Rocket Combustors,'' \textit{AIAA Scitech Forum}, 2021.
			\item \textbf{Wentland, C.R.}, Huang, C., and Duraisamy, K., ``Closure of Reacting Flow Reduced-Order Models via the Adjoint Petrov-Galerkin Method,'' \textit{AIAA Aviation Forum}, 2019.
		\end{itemize}
		\item \normalsize Conference presentations
		\vspace{0.5em}
		\begin{itemize}
			\item \tiny \textbf{Wentland, C.R.} and Duraisamy, K., ``Intrusive and Non-intrusive Non-linear Reduced-order Models for Reacting Flows,'' \textit{2021 Annual Meeting of the APS Division of Fluid Dynamics}, Phoenix, AZ, USA.
			\item \textbf{Wentland, C.R.}, Nair, A.S., and Duraisamy, K., ``Nonlinear Manifold Reduced-Order Models for Complex Fluid Flow Systems,'' \textit{2021 SIAM Conference on Computational Science and Engineering}, virtual.
			\item \tiny \textbf{Wentland, C.R.}, Parish, E.J., and Duraisamy, K., ``Closure of Reduced-Order Models Using Statistical Mechanics Approaches,'' \textit{2018 World Congress on Computational Mechanics}, New York, NY, USA.
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{Acknowledgements}
	\begin{itemize}
	    \item Financial support from the US Air Force through the Center of Excellence Grant FA9550-17-1-0195
	    \item Compute support from the US Department of Defense High Performance Computing Modernization Program
		\item Compute support of ConFlux and Lighthouse systems from the University of Michigan Advanced Research Computing division
		\item Nicholas Arnold-Medabalimi for development and maintenance of PLATFORM
	\end{itemize}
	\begin{minipage}{0.15\linewidth}
		\vspace{0.5em}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{back_matter/afrlLogo.png}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.34\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth,trim={2cm 3cm 0em 3cm},clip]{back_matter/afosr.jpg}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.23\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{back_matter/hpcmp.png}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.23\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth,trim={0em 3cm 0em 3cm},clip]{back_matter/arc.png}
		\end{figure}
	\end{minipage}
\end{frame}

\end{document}

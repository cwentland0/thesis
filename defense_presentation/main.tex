\documentclass[]{beamer}

% make header narrower
% \PassOptionsToPackage{height=2em}{beamerouterthemesidebar}

% needed for bold mathmode
\DeclareFontShape{OT1}{cmss}{b}{n}{<->ssub * cmss/bx/n}{}

\usepackage{changepage}
\usepackage{xspace}
\usepackage{soul}
\usepackage{amsfonts}
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\usepackage{framed}
\usepackage{wrapfig}
\usepackage{caption}
\usepackage{tcolorbox}
\usepackage{arydshln}

\mode<presentation> {
\usepackage{subcaption}
\usepackage{algorithm,algorithmic}
\usepackage[titletoc,title]{appendix}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsmath,amssymb}
\usepackage{mathtools}
\captionsetup{compatibility=false}
\usepackage{blindtext}
\usepackage{tcolorbox}
\usepackage[draft]{animate}
\usepackage{comment}
\usepackage{appendixnumberbeamer}
\usepackage{booktabs}
\usepackage{tikz}
\usetikzlibrary{calc,matrix}

\usetheme{AnnArbor}

\definecolor{myblue}{rgb}{0,0.156,0.375}
\definecolor{mymaize}{rgb}{1.,0.824,0.227}
\definecolor{beamer@myblue}{rgb}{0.02,0.1786,0.37109}
\definecolor{beamer@mymaize}{rgb}{1.,0.824,0.227}
\setbeamercolor{structure}{fg=beamer@myblue}
\setbeamercolor*{title}{use=structure,bg=beamer@mymaize,fg=beamer@myblue}
\setbeamercolor*{frametitle}{use=structure,bg=beamer@mymaize,fg=beamer@myblue}
\setbeamercolor*{palette primary}{use=structure,fg=beamer@mymaize,bg=beamer@myblue}
\setbeamercolor*{palette secondary}{use=structure,fg=beamer@mymaize,bg=beamer@myblue}
\setbeamercolor*{palette tertiary}{use=structure,fg=beamer@mymaize,bg=beamer@myblue}

\setbeamertemplate{frametitle}{%
    \nointerlineskip%
    \begin{beamercolorbox}[wd=\paperwidth,ht=2.5ex,dp=1ex]{frametitle}
        \hspace*{1ex}\insertframetitle%
    \end{beamercolorbox}%
}

\usepackage{appendixnumberbeamer}
\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}

\usepackage{textpos}
}

\newcommand*{\Scale}[2][4]{\scalebox{#1}{$#2$}}%
\newcommand*{\Resize}[2]{\resizebox{#1}{!}{$#2$}}%

% \addtobeamertemplate{frametitle}{}{%
% \begin{textblock*}{155mm}(-0.19\textwidth,-1.35cm)
% \end{textblock*}}

\usepackage{xcolor}

\beamertemplatenavigationsymbolsempty
\addtobeamertemplate{navigation symbols}{}{%
    \usebeamerfont{footline}%
    \usebeamercolor[fg]{footline}%
    \hspace{1em}%
    % \insertframenumber/\inserttotalframenumber
}

% Syntax: \colorboxed[<color model>]{<color specification>}{<math formula>}
\newcommand*{\colorboxed}{}
\def\colorboxed#1#{%
  \colorboxedAux{#1}%
}
\newcommand*{\colorboxedAux}[3]{%
  % #1: optional argument for color model
  % #2: color specification
  % #3: formula
  \begingroup
    \colorlet{cb@saved}{.}%
    \color#1{#2}%
    \boxed{%
      \color{cb@saved}%
      #3%
    }%
  \endgroup
}

\makeatletter
\newcommand{\miniscule}{\@setfontsize\miniscule{4}{5}}% \tiny: 5/6
\makeatother

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

\useoutertheme{miniframes}

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{section in head/foot shaded}{\color{gray}\usebeamertemplate{section in head/foot}}

\setbeamertemplate{headline}{%
  \begin{beamercolorbox}[colsep=1.5pt]{upper separation line head}
  \end{beamercolorbox}
  \begin{beamercolorbox}{section in head/foot}
    \vskip2pt\insertsectionnavigationhorizontal{\paperwidth}{}{}\vskip2pt
  \end{beamercolorbox}%
  \begin{beamercolorbox}[colsep=1.5pt]{lower separation line head}
  \end{beamercolorbox}
}

\input{commands}
\graphicspath{{./Images/}}

%---------------------------------------------------
%	TITLE PAGE
%---------------------------------------------------

\title[]{Robust and Scalable Projection-based \\ Reduced-order Models for Reacting Flows}

\institute[University of Michigan]
{
\vspace{0.3 in}
\Large Christopher R. Wentland \\
\small \underline{Dissertation Committee} \\
Karthik Duraisamy \\
Cheng Huang \\
Jesse Capecelatro \\
Krzysztof Fidkowski \\
\vspace{1em}
\tiny University of Michigan, Ann Arbor - Computational Aerosciences Laboratory
}

\date{\today}

\begin{document}
\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

\section*{Intro}

\begin{frame}{``New space'' era}
    \begin{itemize}
        \item Varying mission parameters
        \begin{itemize}
            \item Payload: satellite, probe, lander, humans
            \item Trajectory: LEO/GTO, translunar, deep space
            \item Capacity: 100 - 150,000 kg to LEO
        \end{itemize}  
        \item Many propulsion configurations
        \begin{itemize}
            \item Solid, bipropellant, hypergolic
            \item (Non-)cryogenic liquid, gaseous propellant 
            \item Injector geometry, flow rates
            \item Gas-generator, expander, tap-off power cycle
        \end{itemize}
    \end{itemize}
	\vspace{1em}
	\begin{minipage}{0.33\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{intro/be4.jpg}
			\caption*{\tiny{Blue Origin, 2018}}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.33\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{intro/aeonR.png}
			\caption*{\tiny{Relativity Space, 2022}}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.28\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{intro/delphin.jpeg}
			\caption*{\tiny{John Kraus, 2021}}
		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Cost of experiments (in 2022 USD)}
    \begin{itemize}
        \item Rocketdyne F-1 (Saturn V)
        \begin{itemize}
            \item \$4.8 billion development cost
            \item \$30 million per unit
            \item \$1.6 billion per launch
        \end{itemize}
        \item SpaceX Merlin 1D (Falcon Heavy)
        \begin{itemize}
            \item \$1 million per unit
            \item \$97 million per launch
        \end{itemize}
    \end{itemize}
	\begin{minipage}{0.49\linewidth}
		\begin{figure}
			\includegraphics[width=0.9\linewidth]{intro/f1TestStand.jpg}
			\caption*{\tiny{NASA, 1966}}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.49\linewidth}
		\begin{figure}
			\includegraphics[width=0.9\linewidth]{intro/merlin1dTestStand.jpg}
			\caption*{\tiny{SpaceX, 2013}}
		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Cost of simulations}
    \begin{itemize}
        \item IBM Summit at ORNL
        \begin{itemize}
            \item $\sim$\$200 million (2019 USD) to design and build
            \item 13 MW peak consumption ($\sim$11,000 homes)
            \item $\sim$\$10 million annual energy cost (overestimated)
        \end{itemize}
        \item Combustion LES/DNS
        \begin{itemize}
			\item Years to develop/validate code
            \item $\numDOF \sim \; \text{Re}^{9/4}$
            \item 50+ species, 100+ reactions
            \item $\Delta t = \mathcal{O}(1\text{e-}9 \; s)$
        \end{itemize}
    \end{itemize}
	\centering
	\begin{minipage}{0.3\linewidth}
		\centering
		\begin{figure}
			\centering
			\includegraphics[width=0.87\linewidth]{intro/combustionDNS.png}
			\caption*{\tiny{Treichler et al, 2017}}
		\end{figure}
	\end{minipage}
	\hspace{1cm}
	\centering
	\begin{minipage}{0.3\linewidth}
		\centering
		\begin{figure}
			\centering
			\includegraphics[width=0.91\linewidth]{intro/jetCrossflowDNS.png}
			\caption*{\tiny{Grout et al., 2011}}
		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Data-driven reduced-order models (ROMs)}
	\begin{itemize}
		\item Learning low-cost models from high fidelity simulations, experiments
		\item Evolving \textbf{low-dimensional} state approximation in time
		\item Non-intrusive methods
		\begin{itemize}
			\item Only require system output
			% \item Black/gray box models
			\item Kriging, operator inference, ANNs
		\end{itemize}
		\item Intrusive methods
		\begin{itemize}
			\item Directly manipulate governing equations
			\item Galerkin, Petrov--Galerkin projection
		\end{itemize}
		\item \textbf{Not} reduced-physics models, e.g.
		\begin{itemize}
			\item Reduced chemical mechanisms
			\item Flamelet-progress variable models
			\item Flame transfer functions
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{Projection-based ROMs (PROMs) of non-linear systems}
    \begin{itemize}
        \item Mapping from low-dim latent space to approximate solution manifold
        \item Map governing equations onto low-dim manifold, evolve in time
    \end{itemize}
	\centering
	\begin{minipage}{0.49\linewidth}
		\centering
		\vspace{-2em}
		\begin{align*}
			\ode{\stateVec}{\timeVar} = \rhsFunc{\stateVec}&, \quad \ode{\stateVecCoef}{\timeVar} = \encoderFunc{\rhsFunc{\decoderFunc{\stateVecCoef}}} \\[1em]
			\stateVec \in \mathbb{R}^{\numDOF}&, \quad \stateVecCoef \in \mathbb{R}^{K} \\[1em]
			\numDOF &\gg K
		\end{align*}
	\end{minipage}
	\hspace{-2em}
	\begin{minipage}{0.49\linewidth}
		\begin{figure}
			\only<1>{\includegraphics[width=0.9\linewidth]{Images/theory/mapExample_3d.png}}
			\only<2>{\includegraphics[width=0.9\linewidth]{Images/theory/mapExample_2d.png}}
		\end{figure}
	\end{minipage}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		PROMs of non-linear systems have \textbf{no stability guarantees}
	\end{tcolorbox}
\end{frame}

\begin{frame}{Prior work}
	\begin{itemize}
		\item 2000's
		\begin{itemize}
			\item Balanced truncation, balanced POD (Willcox, Benner) 
			\item Galerkin PROMs for fluid flows (Rowley, Bui-Thanh)
		\end{itemize}
		\item 2010's
		\begin{itemize}
			\item Least-squares Petrov--Galerkin PROMs (Carlberg, Farhat)
			\item MPE, DEIM, GNAT (Willcox, Chaturantabut, Carlberg)
			\item Closure and stabilization (Tezaur, Iliescu, San, Duraisamy)
			\item Local trial bases, dictionary methods (Amsallem, Zahr)
		\end{itemize}
		\item 2020's
		\begin{itemize}
			\item Non-intrusive ROMs (Willcox, Hesthaven)
			\item Non-linear manifold PROMs (Lee, Choi)
			\item Online basis and sampling adaptation (Peherstorfer, Huang)
		\end{itemize}
		
	\end{itemize}
\end{frame}

\begin{frame}{Objectives}
	\begin{itemize}
		\item How are PROMs best extended to \textbf{reacting flows}?
		\item What methods promote \textbf{accurate} and \textbf{scalable} PROM solutions? 
		\item Can PROMs be truly \textbf{predictive} for large-scale systems?
		\item What \textbf{nuances} does the literature fail to adequately detail?
	\end{itemize}

	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_temp/fig_z_Temperature_}{50000}{55000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_z/fig_z_Flamelet_Scalar_Mean_}{50000}{55000}
		\end{minipage}
		\begin{minipage}{0.45\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=60]{10}{Images/experiments/9elem/fom_pressure/fig_z_Static_Pressure_}{215000}{218900}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{Contributions}
    \begin{enumerate}
		\item PERFORM, open-source Python package for rapid prototyping novel ROM methods, challenging benchmarks
		\item Scalable PROM solver in high-performance combustion CFD code
        \item State-of-the-art PROMs for multi-scale, multi-physics flow systems
        \item Analysis of cost and performance of sparse sampling methods
        \item First study of PROMs for 3D multi-injector rocket combustor, containing $>$ 250 million DOFs
        \item Truly predictive PROMs for single-element rocket combutor
        \item Best practices for PROMs of multi-scale systems
    \end{enumerate}
\end{frame}

\section*{PROMs}

\begin{frame}{Projection-based ROMs}
    \begin{itemize}
		\item General non-linear ODE
		\begin{equation*}
			\ode{\consVec}{\timeVar} + \rhsFunc{\consVec} = \zeroVec \quad \consVec \in \mathbb{R}^{\numDOF}
		\end{equation*}
			\item Low-dimensional affine representation ($\numConsModes \ll \numDOF$)
		\begin{align*}
			\consVec(\timeVar) \approx \consVecRom(\timeVar) &\defEq \consVecCent + \consScale \sum^{\numConsModes}_{i=1} \consVarCoef{i}(\timeVar) \consTrialVec{i} \\
			&= \consVecCent + \consScale \consTrial \consVecCoef(\timeVar)
		\end{align*}
		\begin{equation*}
			\consVecCoef \in \mathbb{R}^{\numConsModes}, \; \consTrial \in \mathbb{R}^{\numDOF \times \numConsModes}
		\end{equation*}
		\item Centering profile $\consVecCent$ and scaling matrix $\consScale$ are crucial; more later
		\begin{equation*}
			\consScale \defEq \text{diag}\left( \consScaleVar{1}, \; \consScaleVar{2}, \; \hdots \;, \; \consScaleVar{\numDOF} \right)
		\end{equation*}
	\end{itemize}
\end{frame}

\begin{frame}{Linear trial space}
    \begin{itemize}
        \item The proper orthogonal decomposition (POD)\footnotemark[1]
        \begin{equation*}
            \consTrial = \argmin{\dummyMatOne \in \mathbb{R}^{\numDOF \times \numConsModes}} \norm{\consDataMat - \dummyMatOne \dummyMatOne^\top \consDataMat}_2^2
        \end{equation*}
        \begin{equation*}
            \consDataMat = \basisMat \singVecMat \rightSingVecMat^\top, \quad \consTrial \leftarrow \basisMat[:, {:}\numConsModes]
        \end{equation*}
    \end{itemize}
	\centering
	\vspace{-0.8em}
	\begin{figure}
		\includegraphics[width=0.5\linewidth]{theory/podProfileConverge.png}
	\end{figure}
	\footnotetext[1]{\tiny{Berkooz et al., \textit{Annu Rev Fluid Mech}, Vol. 25, 1993.}}
\end{frame}

\begin{frame}{The test basis}
    \begin{itemize}
        \item Inserting approximation, no order reduction yet
        \begin{equation*}
            \resScaleInv \left[\consScale \consTrial \ode{\consVecCoef}{\timeVar} + \rhsFunc{\consVecCent + \consScale \consTrial \consVecCoef}\right] = \zeroVec 
        \end{equation*}
        \item Project via test basis $\testBasis \in \mathbb{R}^{\numDOF \times \numConsModes}$, rearrange
        \begin{equation*}
            \ode{\consVecCoef}{\timeVar} + \left[ \testBasis^\top \resScaleInv \consScale \consTrial \right]^{-1} \testBasis^\top \resScaleInv \rhsFunc{\consVecRom} = \zeroVec
        \end{equation*}
        \item $\testBasis = \consTrial$: Galerkin projection
        \item $\testBasis \neq \consTrial$: Petrov--Galerkin projection 
    \end{itemize}
\end{frame}

\begin{frame}{Least-squares Petrov--Galerkin (LSPG)}
    \begin{itemize}
		\item Fully-discrete residual (e.g. BDF1)
		\begin{equation*}
			\resFuncIter{\timeIdx}{\consVecCoef^{\newtonIdx}} \defEq \consScale \consTrial \left( \consVecCoef^{\newtonIdx} - \consVecCoef^{\timeIdx-1} \right) + \dt \, \rhsFunc{\consVecCent + \consScale \consTrial \consVecCoef^{\newtonIdx}} = \zeroVec
		\end{equation*}
		\item Minimize with Gauss--Newton
		\begin{equation*}
			\delta \consVecCoef^{\newtonIdx, \timeIdx} = \argmin{\dummyVec \in \mathbb{R}^{\numConsModes}} \norm{\resScaleInv \left(\pde{\resFuncIter{\timeIdx}{\dummyVec}}{\dummyVec} \dummyVec + \resFuncIter{\timeIdx}{\dummyVec}\right)}_2^2
		\end{equation*}
		\item Equivalent to Petrov--Galerkin projection with test basis\footnotemark[2]
		\begin{equation*}
			\testBasis = \resScaleInv \pde{\resFuncIter{\timeIdx}{\consVecCoef^{\newtonIdx}}}{\consVec} \consScale \consTrial
		\end{equation*}
	\end{itemize}
	\vspace{-1em}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		LSPG is \textbf{discrete-optimal} at every time step
	\end{tcolorbox}
	\footnotetext[2]{\tiny{Carlberg el al., \textit{Int. J. Numer. Meth. Engng}, Vol. 86, 2010.}}
\end{frame}

\begin{frame}{State of the art in 2017}
	\begin{itemize}
		\item PROMs for parametrized elliptic problems are extremely robust\footnotemark[3]
		\item Galerkin ROMs are generally unstable for unsteady problems
		\item LSPG is leap forward, biggest case in 3D Ahmed body\footnotemark[4]
		\item First studies of PROMs for reacting flows suffer from instabilities\footnotemark[5]
	\end{itemize}
	
	\begin{minipage}{0.4\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{theory/ahmed.png}
			\caption*{\tiny{Carlberg et al., 2013}}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.58\linewidth}
		\begin{figure}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth]{10}{theory/single_injector/fom/fig_}{00000}{00046}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth]{10}{theory/single_injector/rom/fig_}{00000}{00046}
			\caption*{\tiny{Huang, 2018}}
		\end{figure}
	\end{minipage}

	\footnotetext[3]{\tiny{Hesthaven et al., \textit{Certified Reduced Basis Methods for Parametrized Partial Differential Equations}, Springer, 2015.}}
	\footnotetext[4]{\tiny{Carlberg et al., \textit{J Comp Phys}, Vol. 242, 2013.}}
	\footnotetext[5]{\tiny{Huang et al., \textit{AIAA Propulsion and Energy}, 2018.}}
\end{frame}

\section*{MP-LSVT}

\begin{frame}{Generalizing least-squares ROMs}
    \begin{itemize}
		\item LSPG trial space formulated for the conserved variables, but \textbf{alternative variables} can prove useful
		\begin{itemize}
			\item Entropy variables
			\item Quadratic lifting variables
		\end{itemize}
		\item Choose \textbf{any} complete set of variables, e.g. primitive variables
		\begin{equation*}
			\stateVar_p \defEq \left[ p, \; u_i, \; T, \; Y_l \right]
		\end{equation*}
		\item Construct linear approximation, supply mapping to conserved variables
		\begin{equation*}
			\primVecRom(\timeVar) \defEq \primVecCent + \primScale \primTrial \primVecCoef(\timeVar)
		\end{equation*}
		\begin{equation*}
			\consVec \defEq \consVec \left( \primVecRom \right)
		\end{equation*}
	\end{itemize}
\end{frame}

\begin{frame}{\small{Model-form preserving least-squares with variable transformation (MP-LSVT)}}
	\begin{itemize}
		\item Frame residual in terms of target state\footnotemark[6]
		\begin{equation*}
			\resFuncIter{\timeIdx}{\primVecCoef^{\newtonIdx}} \defEq \consFunc{\primVecCent + \primScale \primTrial \primVecCoef^{\newtonIdx}} - \consVec^{\timeIdx-1} + \dt \, \rhsFunc{\primVecCent + \primScale \primTrial \primVecCoef^{\newtonIdx}} = \zeroVec
		\end{equation*}
		\item Gauss--Newton w/r/t \textbf{target variable} modal coefficients
		\begin{equation*}
			\testBasis = \resScaleInv \pde{\resFuncIter{\timeIdx}{\primVecCoef^{\newtonIdx}}}{\primVec} \primScale \primTrial
		\end{equation*}
	\end{itemize}
	\begin{minipage}{0.4\linewidth}
		\centering
		\begin{figure}
			\includegraphics[width=0.9\linewidth]{theory/mplsvt_err_vs_modes.png}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.58\linewidth}
		\begin{tcolorbox}[colframe=blue!50!white,halign=center]
			MP-LSVT greatly ehnances accuracy and conditioning for \textbf{extremely stiff} systems
		\end{tcolorbox}
	\end{minipage}
	\footnotetext[6]{\tiny{Huang, \textbf{Wentland}, and Duraisamy, \textit{J Comp Phys.}, Vol. 448, 2022.}}
\end{frame}

\begin{frame}{MP-LSVT for stiff systems}
	
\end{frame}

\section*{Hyper-reduction}

\begin{frame}{The lifting bottleneck}
    \begin{itemize}
		\item Non-linear terms $\rhsFunc{\primVecRom}$ still scale with full dimension $\numDOF$
		\item For same time integrator and \dt, ROM is usually \textbf{more} expensive
		\item Can we approximate non-linear terms from a few samples?
		\begin{equation*}
			\rhsFunc{\primVec} \approx \sampFunc{\sampMat \rhsFunc{\primVec}}, \quad \sampMat \in \mathbb{R}^{\numSamps \times \numDOF}
		\end{equation*}
	\end{itemize}
	\vspace{1em}
	\begin{figure}
		\centering
		\includegraphics[width=0.55\linewidth]{theory/samplingHelperVis.png}
	\end{figure}
\end{frame}

\begin{frame}{Hyper-reduction by gappy POD}
    \begin{itemize}
		\item Approximate non-linear terms with POD basis $\deimBasis \in \mathbb{R}^{\numDOF \times \numResModes}$, sample
		\begin{equation*}
			\sampMat \resApproxFunc{\primVecCoef} = \sampMat \deimBasis \dummyVec
		\end{equation*}
		\item Least-squares regression, gappy POD\footnotemark[7] ($\numSamps > \numResModes$)
		\begin{equation*}
			\resApproxFunc{\primVecCoef} \defEq \deimBasis \left[ \sampMat \deimBasis \right]^{+} \sampMat \resFunc{\primVecCoef}
		\end{equation*}
		\item MP-LSVT hyper-reduced PROM (HPROM)
		\begin{equation*}
			\left[ \testBasis^\newtonIdx \right]^\top \testBasis^\newtonIdx \delta \primVecCoef^{\newtonIdx} = -\left[\testBasis^\newtonIdx \right]^\top \deimBasis \left[ \sampMat \deimBasis \right]^{+} \sampMat \resScaleInv \resFunc{\primVecCoef^{\newtonIdx}}
		\end{equation*}
		\begin{equation*}
			\testBasis^\newtonIdx \defEq \deimBasis \left[ \sampMat \deimBasis \right]^{+} \sampMat \resScaleInv \jacobResPrim^{\newtonIdx} \primTrial
		\end{equation*}
	\end{itemize}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		HPROM is \textbf{independent} of full-order dimension $\numDOF$
	\end{tcolorbox}
	\footnotetext[7]{\tiny{Everson and Sirovich, \textit{J Opt Soc Am A}, Vol. 12 (8), 1995, pp 1657--1664.}}
\end{frame}

\begin{frame}{Sampling algorithms}
    \begin{itemize}
		\item Computing optimal sampling $\sampMat$ is intractable
		\item Usually resort to greedy (locally-optimal) algorithms
		\begin{itemize}
			\item GNAT (two variants)$^{5,8}$
			\item Eigenvector-based\footnotemark[8]
		\end{itemize}
	\end{itemize}
	\vspace{-1em}
	\begin{minipage}{0.13\linewidth}
		\footnotesize
		\vspace{3.9em}
		\textbf{Random}
		\normalsize

		\vspace{3em}

		\footnotesize
		\textbf{GNAT}

		\vspace{3.7em}

		\footnotesize
		\textbf{Eigenvec}

		\vspace{4em}
	\end{minipage}
	\centering
	\begin{minipage}{0.8\linewidth}%{0.84\linewidth}
		\includegraphics[width=0.85\linewidth,trim={0.2em 2em 0.3em 2em},clip]{Images/theory/iblanks/random_iblank_z.png}

		\includegraphics[width=0.85\linewidth,trim={0.2em 2em 0.3em 2em},clip]{Images/theory/iblanks/greedy_ben_iblank_z.png}

		\includegraphics[width=0.85\linewidth,trim={0.2em 2em 0.3em 2em},clip]{Images/theory/iblanks/eigenvec_iblank_z.png}
	\end{minipage}
	\vspace{-2em}
	\footnotetext[8]{\tiny{Peherstorfer et al., \textit{SIAM J Comp Sci}, Vol. 42, 2020.}}
\end{frame}

\begin{frame}{Methodology review}
	\begin{itemize}
		\item ROMs leverage data to build low-dimensional approximations
		\item Galerkin and LSPG PROMs fail for reacting flows
		\item MP-LSVT PROMs enhance stability and accuracy for stiff systems
		\item Gappy POD enables scalable solutions, unlocks cost savings
		\item Greedy algorithms make principled estimates, but vary greatly
	\end{itemize}
\end{frame}

\section*{}

\begin{frame}{Full-order model}
    \begin{itemize}
		\item Compressible Navier--Stokes equations with scalar transport
		\item 2nd-order unstructured finite volume
		\item BDF2 time integration w/ pseudo time-stepping
		\item Finite-rate and flamelet-progress variable chemistry models
	\end{itemize}
	\begin{equation*}
		\pde{\consVec}{\timeVar} + \nabla \cdot (\invFluxDir - \viscFluxDir) = \sourceVec
	\end{equation*}
	\scriptsize
	\def\arraystretch{2}
	\begin{equation*}
		\consVec = \left[
		\begin{array}{c}
		\rho \\ \rho u \\ \rho v \\ \rho w \\ \rho h^0 - p \\ \hdashline[2pt/2pt] \rho Y_{\specIdx} \\
		\end{array}
		\right]  \; \;
		\invFluxDir = \left[
		\begin{array}{c}
		\rho u_i \\  \rho uu_i + \delta_{xi} p \\ \rho vu_i + \delta_{yi} p \\ \rho wu_i + \delta_{zi} p \\ \rho h^0 u_i \\ \hdashline[2pt/2pt] \rho Y_{\specIdx} u_i 
		\end{array}
		\right]  \; \;
		\viscFluxDir = \left[
		\begin{array}{c}
		0 \\ \tau_{ix} \\ \tau_{iy} \\ \tau_{iz} \\ u_j \tau_{ji} - q_i \\ \hdashline[2pt/2pt] \rho D_\specIdx  \pde{Y_{\specIdx}}{x_i}
		\end{array}
		\right]  \; \;
		\mathbf{s} = \left[
		\begin{array}{c}
		0 \\ 0 \\ 0 \\ 0 \\ 0 \\ \hdashline[2pt/2pt] \dot{\omega}
		\end{array} \right]
	\end{equation*}
	\normalsize
\end{frame}

\section*{PERFORM}

\begin{frame}{\footnotesize{Prototyping Environment for Reacting Flow Order Reduction Methods (PERFORM)}}
	\begin{itemize}
		\small
		\item Open-source 1D reacting flow solver w/ flexible ROM API\footnotemark[9]
		\item Used for linearized ROMs\footnotemark[10], adaptive HPROMs\footnotemark[11], AERO 577 projects
		\normalsize
	\end{itemize}
	\vspace{0.5em}
	\begin{minipage}{0.49\linewidth}
		\includegraphics[width=0.99\linewidth]{Images/experiments/transientFlame/performFOMAPI.png}
	\end{minipage}
	\begin{minipage}{0.49\linewidth}
		\includegraphics[width=0.99\linewidth]{Images/experiments/transientFlame/performROMAPI.png}
	\end{minipage}

	\vspace{1em}
	\centering
	\texttt{https://github.com/cwentland0/perform}
	\footnotetext[9]{\tiny{\textbf{Wentland} and Duraisamy, \textit{J Open Source Soft.}, 2022.}}
	\footnotetext[10]{\tiny{Rezaian et al., \textit{Phil. Trans. Royal Soc. A}, Vol. 380, 2022.}}
	\footnotetext[11]{\tiny{Uy et al., \textit{arXiv:2209.06957}, 2022.}}
\end{frame}

\begin{frame}{Acoustically-forced model premixed flame}
	\begin{itemize}
		\item Compare linear and non-linear manifold intrusive PROMs, non-intrusive neural network approaches
	\end{itemize}

	\centering
	\begin{figure}
		\animategraphics[controls={play,stop},buttonsize=1em,width=0.59\linewidth,every=1]{5}{Images/experiments/transientFlame/agg/fig_}{1}{50}
	\end{figure}
	
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		Explore \textbf{novel} ROMs for \textbf{challenging} benchmark problems
	\end{tcolorbox}
\end{frame}

\section*{Scalable PROMs}

\begin{frame}{HPROMs of multi-scale, multi-physics system}
	\begin{itemize}
		\item HPROMs rarely tested for larger, practical systems
		\item Understanding the effects of:
		\begin{itemize}
			\item Sampling rate $\numSamps$
			\item Gappy POD regressor dimension $\numResModes$
			\item Sampling algorithm
		\end{itemize}
		\item Stability, accuracy, load balancing,computational cost
	\end{itemize}

	\begin{equation*}
		\ell^2\text{-error} = \frac{1}{\numSnaps} \sum_{\timeIdx=1}^{\numSnaps} \frac{\left\Vert \primVec^{\timeIdx} - \primVecRom^{\timeIdx} \right\Vert_2}{\left\Vert \primVec^{\timeIdx} \right\Vert_2}
	\end{equation*}

	\begin{equation*}
		\text{Speedup ratio} = \frac{(\text{FOM wall time}) \times (\text{\# FOM cores})}{(\text{ROM wall time}) \times (\text{\# ROM cores})}
	\end{equation*}
\end{frame}

\begin{frame}{2D transonic flow over an open cavity}
    \begin{itemize}
		\item Ma = 0.6 flow over rectangular cavity\footnotemark[12]
		\item Validation for non-reacting multi-scale system
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.59\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=50]{10}{Images/experiments/2d_cavity/fom_pressure/fig_Static_Pressure_}{100000}{103000}
		\end{minipage}
		\begin{minipage}{0.4\linewidth}
			\includegraphics[width=0.99\linewidth]{experiments/2d_cavity/psd_fom_100ms.png}
		\end{minipage}
	\end{figure}

	\footnotetext[12]{\tiny{Tezaur et al., \textit{Tech. report Sandia National Laboratories}, 2017.}}
\end{frame}

\begin{frame}{HPROM performance}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/2d_cavity/sampled_dt2p5e-6_Average_errorRaw_pareto.png}
		\end{minipage}
		\begin{minipage}{0.4\linewidth}
			\centering
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.75\linewidth,every=40]{10}{Images/experiments/2d_cavity/fom_pressure_zoom/fig_Static_Pressure_zoom_}{108000}{110000}
			
			\centering
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.75\linewidth,every=16]{10}{Images/experiments/2d_cavity/hprom_pressure_zoom/fig_Static_Pressure_zoom_}{43200}{44000}
			\caption*{$\numResModes = 250, \numSamps = 1\%$}
		\end{minipage}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		\textbf{Extreme sensitivity} to sampling method	
	\end{tcolorbox}
\end{frame}

\begin{frame}{3D trucated CVRC combustor}
	\begin{itemize}
		\item Truncated single-element gaseous methane-peroxide combustor\footnotemark[13]
		\item Flamelet-progress variable combustion model (GRI-Mech 1.2)
		\item $\sim$18 mil. DOF, 880 cores $\rightarrow$ 30k CPU-h per simulated millisecond
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
				\includegraphics[width=0.95\linewidth]{Images/experiments/cvrc/geom.png}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_pressure/fig_z_Static_Pressure_}{50000}{55000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_temp/fig_z_Temperature_}{50000}{55000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_z/fig_z_Flamelet_Scalar_Mean_}{50000}{55000}
		\end{minipage}
	\end{figure}

	\footnotetext[13]{\tiny{Harvazinski et al., \textit{Phys. Fluids}, Vol. 27, 2015.}}
\end{frame}

\begin{frame}{Sparse sampling}
	\begin{figure}
		\centering
		\begin{minipage}{0.3\linewidth}
			\includegraphics[width=0.99\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/cvrc/iblank/random_iblank_iso.png}
			\subcaption{Random}
		\end{minipage}
		\begin{minipage}{0.3\linewidth}
			\includegraphics[width=0.99\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/cvrc/iblank/eigenvec_iblank_iso.png}
			\subcaption{Eigenvector}
		\end{minipage}
	
		\centering
		\begin{minipage}{0.3\linewidth}
			\includegraphics[width=0.99\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/cvrc/iblank/greedy_carlberg_iblank_iso.png}
			\subcaption{GNAT V1}
		\end{minipage}
		\begin{minipage}{0.3\linewidth}
			\includegraphics[width=0.99\linewidth,trim={0.5em 0.5em 0.5em 0.5em},clip]{Images/experiments/cvrc/iblank/greedy_ben_iblank_iso.png}
			\subcaption{GNAT V2}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{Offline cost}
	\begin{itemize}
		\item Sampling cost in terms of FOM iteration cost 
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/samp_timing_wrt_samprate.png}
			\caption*{$\numResModes = 300$}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/samp_timing_wrt_modes.png}
			\caption*{$\numSamps = 0.25\% \times \numDOF$}
		\end{minipage}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		Random sampling costs \textbf{nothing} \\
		Greedy methods scale \textbf{exponentially} with $\numSamps$
	\end{tcolorbox}
\end{frame}

\begin{frame}{Load balancing (18 mil. DOF)}
	\begin{itemize}
		\item How the mesh is divided between parallel processes
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/cvrc_partition_stats.png}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/cvrc_partition_comms.png}
		\end{minipage}
		\caption*{10 partitions, various $\numSamps$.}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		Random meshes are \textbf{large}, but \textbf{disjoint} \\
		Greedy meshes are \textbf{small}, but induce \textbf{high MPI overhead}
	\end{tcolorbox}
\end{frame}

\begin{frame}{HPROM performance (18 mil. DOF)}
	\begin{figure}
		\begin{minipage}{0.35\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/err_contour_random_dt5e-7.png}
			\subcaption{\scriptsize{Random}}
		\end{minipage}
		\begin{minipage}{0.4\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/err_contour_eigenvec_dt5e-7.png}
			\subcaption{\scriptsize{Eigenvector}}
		\end{minipage}
	
		\begin{minipage}{0.35\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/err_contour_gnat1_dt5e-7.png}
			\subcaption{\scriptsize{GNAT, V1}}
		\end{minipage}
		\begin{minipage}{0.4\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/err_contour_gnat2_dt5e-7.png}
			\subcaption{\scriptsize{GNAT, V2}}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{HPROM performance (18 mil. DOF)}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/sampled_dt5e-7_Average_errorRaw_pareto.png}
			\caption*{$\dt = 5 \times \dtFOM$}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/pressure_probe_deim_dt5e-7_samp0p0025.png}
			\caption*{$\numResModes = 300$, $\numSamps = 0.25\% \times \numDOF$}
		\end{minipage}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		\textbf{Eigenvector-based sampling} consistently outperforms \\
		$10^3$-$10^4$ cost savings with \textbf{minimal accuracy loss}
	\end{tcolorbox}
\end{frame}

\begin{frame}{HPROM performance (18 mil. DOF)}
	\begin{minipage}{0.15\linewidth}
		\textbf{FOM}

		\vspace{2.5em}

		\textbf{Random}

		\vspace{2.5em}

		\textbf{Eigenvec}

		\vspace{2.5em}

		\textbf{GNAT V1}

		\vspace{2.5em}

		\textbf{GNAT V2}

	\end{minipage}\hspace{2em}
	\begin{minipage}{0.6\linewidth}
		\begin{figure}
		
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=50]{10}{Images/experiments/cvrc/fom_temp_comp/fig_z_Temperature_}{52500}{55000}
	
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=10]{10}{Images/experiments/cvrc/random_temp/fig_z_Temperature_}{10500}{11000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=10]{10}{Images/experiments/cvrc/eigenvec_temp/fig_z_Temperature_}{10500}{11000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=10]{10}{Images/experiments/cvrc/gnatv1_temp/fig_z_Temperature_}{10500}{11000}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=10]{10}{Images/experiments/cvrc/gnatv2_temp/fig_z_Temperature_}{10500}{11000}

		\end{figure}
	\end{minipage}
	
\end{frame}


\begin{frame}{3D nine-element combustor}
	\begin{itemize}
		\item Air Force Center of Excellence ``grand challenge'' case\footnotemark[14]
		\item 12 species, 38 reaction mechanism 
		\item 238 mil. DOF, 2,200 cores $\rightarrow ~\sim$400k CPU-h per 1T mode
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.45\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/9elem/geom_iso.png}
		\end{minipage}
		\begin{minipage}{0.45\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=60]{10}{Images/experiments/9elem/fom_pressure/fig_z_Static_Pressure_}{215000}{218900}
		\end{minipage}
	\end{figure}
	\footnotetext[14]{\tiny{Harvazinski et al., \textit{AIAA Scitech Forum}, 2019}}
\end{frame}

\begin{frame}{Unsampled PROM perfomance}
	\begin{itemize}
		\item Faithful reconstruction with $\numPrimModes \ge 80$
		\item Pressure field lacks some high-frequency content
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/9elem/point_3_Static_Pressure.png}
		\end{minipage}
		\begin{minipage}{0.45\linewidth}
			\animategraphics[autoplay,loop,trim=1em 1em 1em 1em,width=0.99\linewidth,every=2]{6}{Images/experiments/9elem/rom_pressure/fig_z_Static_Pressure_}{4302}{4380}
		\end{minipage}
	\end{figure}
\end{frame}

\begin{frame}{HPROM takeaways}
	\begin{itemize}
		\item MP-LSVT exhibits excellent stability and accuracy
		\item Offline cost of greedy methods can be significant
		\item Performance is extremely sensitive to sampling algorithm
		\begin{itemize}
			\item Eigenvector-based sampling is clear victor
			\item Traditional GNAT often worse than random sampling
		\end{itemize}
		\item Over three orders of magnitude cost savings
		\item Faithful modeling of complex combustion phenomena
	\end{itemize}
\end{frame}

\section*{Adaptive PROMs}

\begin{frame}{Predictive PROMs}
	\begin{itemize}
		\item Out-of-training predictions
		\begin{itemize}
			\item Future-state
			\item Parametric variations (BC's, reaction, etc.)
			\item Geometric variations
		\end{itemize}
		\item Static trial space cannot represent unseen data
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.9\linewidth]{Images/experiments/cvrc/proj_err_time.png}
		\end{minipage}	
		\begin{minipage}{0.49\linewidth}
			\animategraphics[autoplay,loop,trim={0.5em 0.5em 0.5em 0.5em},clip,width=0.99\linewidth,every=40]{10}{Images/experiments/cvrc/fom_temp_adapt/fig_z_Temperature_}{54000}{56000}	
			
			\animategraphics[autoplay,loop,trim={0.5em 0.5em 0.5em 0.5em},clip,width=0.99\linewidth,every=40]{10}{Images/experiments/cvrc/proj_temp/fig_z_Temperature_}{54000}{56000}	
		\end{minipage}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		True predictivity requires \textbf{adaptation}
	\end{tcolorbox}
\end{frame}

\begin{frame}{Basis and sampling adaptation}
	\begin{itemize}
		\item Periodic queries of full-order operator at interval $\updateFreq$
		\item AADEIM\footnotemark[15] sampling update criterion
		\begin{equation*}
			\argmax{} \primVec - \primTrial \left[\sampMat \primTrial\right]^+ \sampMat \primVecRom
		\end{equation*}
		\item One-step basis adaptation\footnotemark[16]
		\begin{equation*}
			\primVec^{\timeIdx} = \primVecCent + \primScale \left[\primTrial^{\timeIdx} + \left[\primTrialUpdate\right]^{\timeIdx} \right] \primVecCoef^{\timeIdx},
		\end{equation*}
		\begin{equation*}
			\sampMat^{\timeIdx} [\primTrialUpdate]^{\timeIdx+1} = \sampMat^{\timeIdx} [\primTrialUpdate]^{\timeIdx} + \frac{\sampMat^{\timeIdx} \left[\primScaleInv\left[\primVec^{\timeIdx} - \primVecCent\right] - \primTrial^{\timeIdx} \primVecCoef^{\timeIdx}\right]\left[\primVecCoef^{\timeIdx}\right]^\top}{\left\Vert \primVecCoef^{\timeIdx} \right\Vert^2_2}
		\end{equation*}
	\end{itemize}

	\footnotetext[15]{\tiny{Peherstorfer and Willcox, \textit{SIAM J Sci. Comp.}, Vol. 37, 2015.}}
	\footnotetext[16]{\tiny{Huang et al., \textit{Front. Phys.}, Vol. 10, 2022}}
\end{frame}

\begin{frame}{CVRC future-state predictions}
	\begin{itemize}
		\item Train only on first 0.005 ms, predict for 0.5 ms
		\item Small trial basis, $\numPrimModes \le 10$ 
	\end{itemize}
	\begin{figure}
			% probe showing training bound
			\includegraphics[width=0.5\linewidth]{Images/experiments/cvrc/press_fom_train_bound.png}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		Adaptive PROM incurs \textbf{miniscule offline cost}
	\end{tcolorbox}
\end{frame}

\begin{frame}{Adaptive HPROM performance}
	\begin{itemize}
		\item Increasing $\updateFreq$ decreases cost, causes solution to ``drag''
	\end{itemize}
	\begin{figure}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/pressure_probe_wrt_iter.png}
		\end{minipage}
		\begin{minipage}{0.49\linewidth}
			\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/pareto_wrt_iters_Average_errorRaw_pareto.png}
		\end{minipage}
	\end{figure}

\end{frame}

\begin{frame}{Adaptive HPROM performance}
	\begin{minipage}{0.15\linewidth}
		\textbf{FOM}

		\vspace{2.5em}

		$\mathbf{\updateFreq = 2}$

		\vspace{2.5em}

		$\mathbf{\updateFreq = 4}$

		\vspace{2.5em}

		$\mathbf{\updateFreq = 5}$

	\end{minipage}\hspace{2em}
	\begin{minipage}{0.6\linewidth}
		\begin{figure}
		
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=100]{10}{Images/experiments/cvrc/fom_temp_adapt_rom/fig_z_Temperature_}{50100}{55000}
	
			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=2]{10}{Images/experiments/cvrc/adapt_freq2/fig_z_Temperature_}{1002}{1100}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=2]{10}{Images/experiments/cvrc/adapt_freq4/fig_z_Temperature_}{1002}{1100}

			\animategraphics[autoplay,loop,trim=0.5em 0.5em 0.5em 0.5em,width=0.99\linewidth,every=2]{10}{Images/experiments/cvrc/adapt_freq5/fig_z_Temperature_}{1002}{1100}

		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Adaptive PROM takeaways}
	\begin{itemize}
		\item Reasonable predictions where static basis fails outright
		\item Increasing update threshold $\updateFreq$
		\begin{itemize}
			\item Deteriorates point-wise measurements
			\item Retains qualitative flow field behavior
		\end{itemize}
		\item Absolute speedup threshold dictated by $\updateFreq$
		\item Adaptive PROM is \textbf{not} independent of $\numDOF$
	\end{itemize}
\end{frame}

\section*{Best Practices}

\begin{frame}{Best practices}
	\begin{itemize}
		\item Literature often glosses over small, critical details
		\item Feature scaling
		\begin{equation*}
			\primVecRom = \primVecCent + \primScale \primTrial \primVecCoef
		\end{equation*}
		\item Residual non-dimensionalization
		\begin{equation*}
			\delta \primVecCoef^{\newtonIdx, \timeIdx} = \argmin{\dummyVec \in \mathbb{R}^{\numPrimModes}} \norm{\resScaleInv \left(\pde{\resFuncIter{\timeIdx}{\dummyVec}}{\dummyVec} \dummyVec + \resFuncIter{\timeIdx}{\dummyVec}\right)}_2^2
		\end{equation*}
		\item Local limiters
		\begin{equation*}
			\temperature = min\left(max\left(\temperature, \; \temperature_{min}\right), \; \temperature_{max}\right)
		\end{equation*}
		\item Sampling algorithm
	\end{itemize}
\end{frame}

\begin{frame}{Best practices: feature scaling}
	\begin{itemize}
		\item Data preparation is crucial for accurate trial space
		\item Centering: initial condition, mean field
		\item Scaling: $\ell^2$-norm, min-max
	\end{itemize}
	\begin{figure}
		\only<1>{
			\begin{minipage}{0.32\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/errVsModes_centScale_centNone_Average_errorRaw.png}
				\caption*{No centering}
			\end{minipage}
			\begin{minipage}{0.32\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/errVsModes_centScale_centIC_Average_errorRaw.png}
				\caption*{IC centering}
			\end{minipage}
			\begin{minipage}{0.32\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/errVsModes_centScale_centMean_Average_errorRaw.png}
				\caption*{Mean centering}
			\end{minipage}
		}
		\only<2>{
			\begin{minipage}{0.32\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/pressure_probe_centScale_centNone.png}
				\caption*{No centering}
			\end{minipage}
			\begin{minipage}{0.32\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/pressure_probe_centScale_centIC.png}
				\caption*{IC centering}
			\end{minipage}
			\begin{minipage}{0.32\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/pressure_probe_centScale_centMean.png}
				\caption*{Mean centering}
			\end{minipage}
		}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		Centering/scaling are \textbf{required}, \\
		exact method not as important
	\end{tcolorbox}
\end{frame}

\begin{frame}{Best practices: residual non-dimensionalization}
	\begin{itemize}
		\item Failing to non-dimensionalize ROMs leads to poor conditioning
		\item Scaling dataset: $\consVec$, $\rhsFunc{\cdot}$
		\item Scaling method: $\ell^2$-norm, min-max
	\end{itemize}
	\begin{figure}
		\centering
		\only<1>{
			\begin{minipage}{0.4\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/errVsModes_norm_l2_Average_errorRaw.png}
				\caption*{$\ell^2$-norm scaling}
			\end{minipage}
			\begin{minipage}{0.4\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/errVsModes_norm_minmax_Average_errorRaw.png}
				\caption*{Min-max scaling}
			\end{minipage}
		}
		\only<2>{
			\begin{minipage}{0.4\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/pressure_probe_scale_l2.png}
				\caption*{$\ell^2$-norm scaling}
			\end{minipage}
			\begin{minipage}{0.4\linewidth}
				\includegraphics[width=0.99\linewidth]{Images/experiments/cvrc/best_pract/pressure_probe_scale_minmax.png}
				\caption*{Min-max scaling}
			\end{minipage}
		}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		Residual scaling \textbf{halves} time-average error \\
		\textbf{Conservative variable} scaling minimizes solution ``drag''
	\end{tcolorbox}
\end{frame}

\begin{frame}{Best practices: local limiters}
	\begin{itemize}
		\item ``Ringing'' from linear trial basis can lead to large over/undershoots
		\item Bound below by fuel temperature, above by AFT 
	\end{itemize}
	\begin{figure}
		\centering
		\begin{minipage}{0.4\linewidth}
			\includegraphics[width=0.99\linewidth]{example-image-a}
		\end{minipage}
		\begin{minipage}{0.4\linewidth}
			\includegraphics[width=0.99\linewidth]{example-image-a}
		\end{minipage}
	\end{figure}
	\begin{tcolorbox}[colframe=blue!50!white,halign=center]
		System-specific limiters are a \textbf{simple hot-fix}
	\end{tcolorbox}
\end{frame}

\begin{frame}{Best practices: sparse sampling}
	
\end{frame}

\section*{Conclusions}

\begin{frame}{Contributions}
    \begin{enumerate}
        \item State-of-the-art PROMs for multi-scale, multi-physics flow systems
        \item Scalable PROM solver in high-performance combustion CFD code
        \item Analysis of cost and performance of sparse sampling methods
        \item First study of PROMs for 3D multi-injector rocket combustor, containing $>$ 250 million DOFs
        \item Truly predictive PROMs for single-element rocket combutor
        \item PERFORM, Python package for prototyping novel ROM methods
        \item Insight on best practices for PROMs of multi-scale systems
    \end{enumerate}
\end{frame}

\begin{frame}{Publications and presentations}
	\begin{itemize}
		\item Under review
		\vspace{0.5em}
		\begin{itemize}
			\item \tiny \textbf{Wentland, C.R.}, Huang, C., and Duraisamy, K., ``Scalable Projection-based Reduced-order Models for Large Multi-scale Fluid Systems,'' AIAA Journal, submitted for review.
		\end{itemize}
		\item \normalsize Journal articles
		\vspace{0.5em}
		\begin{itemize}
			\item \tiny Arnold-Medabalimi, N., \textbf{Wentland, C. R.}, Huang, C., and Duraisamy, K., ``PLATFORM: Parallel Linear Algebra Tool FOr
			Reduced Modeling,'' \textit{SoftwareX}, Vol. 21, 2023.
			\item \textbf{Wentland, C.R.} and Duraisamy, K., ``PERFORM: A Python package for developing reduced-order models for reacting fluid flows,'' \textit{J. Open Source Softw.}, 2022.
			\item Huang, C., \textbf{Wentland, C.R.}, Duraisamy, K., and Merkle, C., ``Model reduction for multi-scale transport problems using model-form preserving least-squares projections with variable transformation,'' \textit{J. Comp. Phys.}, 2021, Vol. 448, 2021.
        	\item Parish, E.J., \textbf{Wentland, C.R.}, Duraisamy, K., ``The Adjoint Petrov--Galerkin method for non-linear model reduction,'' \textit{Comput. Method Appl. M.}, Vol. 365, 2020.
		\end{itemize}
		\item \normalsize Conference proceedings
		\vspace{0.5em}
		\begin{itemize}
			\item \tiny \textbf{Wentland, C.R.}, Huang, C., and Duraisamy, K., ``Investigation of Sampling Strategies for Reduced-Order Models of Rocket Combustors,'' \textit{AIAA Scitech Forum}, 2021.
			\item \textbf{Wentland, C.R.}, Huang, C., and Duraisamy, K., ``Closure of Reacting Flow Reduced-Order Models via the Adjoint Petrov-Galerkin Method,'' \textit{AIAA Aviation Forum}, 2019.
		\end{itemize}
		\item \normalsize Conference presentations
		\vspace{0.5em}
		\begin{itemize}
			\item \tiny \textbf{Wentland, C.R.} and Duraisamy, K., ``Intrusive and Non-intrusive Non-linear Reduced-order Models for Reacting Flows,'' \textit{2021 Annual Meeting of the APS Division of Fluid Dynamics}, Phoenix, AZ, USA.
			\item \textbf{Wentland, C.R.}, Nair, A.S., and Duraisamy, K., ``Nonlinear Manifold Reduced-Order Models for Complex Fluid Flow Systems,'' \textit{2021 SIAM Conference on Computational Science and Engineering}, virtual.
			\item \tiny \textbf{Wentland, C.R.}, Parish, E.J., and Duraisamy, K., ``Closure of Reduced-Order Models Using Statistical Mechanics Approaches,'' \textit{2018 World Congress on Computational Mechanics}, New York, NY, USA.
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{Financial and compute support}
	\begin{itemize}
	    \item Financial support from the US Air Force through the Center of Excellence Grant FA9550-17-1-0195
	    \item Compute support from the US Department of Defense High Performance Computing Modernization Program
		\item Compute support of ConFlux and Lighthouse systems from the University of Michigan Advanced Research Computing division
	\end{itemize}
	\begin{minipage}{0.15\linewidth}
		\vspace{0.5em}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{back_matter/afrlLogo.png}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.34\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth,trim={2cm 3cm 0em 3cm},clip]{back_matter/afosr.jpg}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.23\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth]{back_matter/hpcmp.png}
		\end{figure}
	\end{minipage}
	\begin{minipage}{0.23\linewidth}
		\begin{figure}
			\includegraphics[width=0.99\linewidth,trim={0em 3cm 0em 3cm},clip]{back_matter/arc.png}
		\end{figure}
	\end{minipage}
\end{frame}

\begin{frame}{Acknowledgements}
	
\end{frame}

\end{document}
